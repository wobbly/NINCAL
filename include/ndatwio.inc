..............................................................................
.
. NDATWIO INCLUSION
* ****************************************************
* NAMES IN THE NEWS DATACARD WEB FILE.
* KEEPS TRACK OF FILES CURRENTLY LOADED ON OUR WEBSITE
* DYNAMICALLY REFRESHED WEEKLY BY NDATW002W.PLS
* ****************************************************
.
.      FILE:      NINDATW
.    LENGTH:      6
.  COMPRESS:      SPACE
.      TYPE:      ISAM,MANAGED
. INDEX KEY:      1-6
.
..............................................................................
.
. ENTRY POINT : NDATWKEY
. REQUIRED    : 'NDATWPATH', 'NDATWFLD'
. RETURNED    : NDATWVARS
. DESCRIPTION : EXACT ISAM KEY READ
.
NDATWKEY
	BRANCH	NDATWPATH,NDATW1,NDATW1X
NDATW1
	BRANCH	NDATWFLAG,NDATW1A
	CALL	NDATWOPEN
NDATW1A
	BRANCH	NDATWLOCK,NDATW1Al,NDATW1AR,NDATW1AN
.with file locks
NDATW1Al
	trap	IOMssg giving Error if IO
	FILEPI	1;NDATWFILE
	READ	NDATWFILE,NDATWFLD;NDATWVARS
	GOTO NDATW1x
.with record locks . note file open must have had flag set
NDATW1AR
	trap	IOMssg giving Error if IO
	READLK	NDATWFILE,NDATWFLD;NDATWVARS
	GOTO NDATW1X
.with NO locks
NDATW1AN
	trap	IOMssg giving Error if IO
	READ	NDATWFILE,NDATWFLD;NDATWVARS
	GOTO NDATW1X
NDATW1X
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NDATWTST
. REQUIRED    : NDATWFLD
. RETURNED    :
. DESCRIPTION : TEST KEY
.
NDATWTST
	BRANCH	NDATWPATH,NDATW2,NDATW3X
NDATW2
	BRANCH	NDATWFLAG,NDATW2A
	CALL	NDATWOPEN
NDATW2A
	trap	IOMssg giving Error if IO
	FILEPI	1;NDATWFILE
	READ	NDATWFILE,NDATWFLD;;
	GOTO NDATW2X
NDATW2X
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NDATWKS
. REQUIRED    : 'NDATWPATH'
. RETURNED    : NDATWVARS
. DESCRIPTION : KEY SEQUENTIAL DATACARD FILE READ
.
NDATWKS
	BRANCH	NDATWPATH,NDATW3A,NDATW3X
NDATW3
	BRANCH	NDATWFLAG,NDATW3A
	CALL	NDATWOPEN
NDATW3A
	BRANCH	NDATWLOCK,NDATW3Al,NDATW3AR,NDATW3AL
NDATW3Al
	trap	IOMssg giving Error if IO
	FILEPI	1;NDATWFILE
	READKS	NDATWFILE;NDATWVARS
	GOTO NDATW3X
NDATW3AR
	trap	IOMssg giving Error if IO
	READKSLK NDATWFILE;NDATWVARS
	GOTO NDATW3X
NDATW3AN
	trap	IOMssg giving Error if IO
	READKS	NDATWFILE;NDATWVARS
	GOTO NDATW3X
NDATW3X
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NDATWSEQ
. REQUIRED    :
. RETURNED    : NDATWVARS
. DESCRIPTION : SEQUENTIAL DATACARD FILE READ
.
NDATWSEQ
	BRANCH	NDATWFLAG,NDATW4
	CALL	NDATWOPEN
NDATW4
	trap	IOMssg giving Error if IO
	FILEPI	1;NDATWFILE
	READ	NDATWFILE,SEQ;NDATWVARS
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NDATWWRT
. REQUIRED    : 'NDATWFLD', 'NDATWPATH=1'
. RETURNED    :
. DESCRIPTION : EXACT ISAM KEY TXT/ISI INSERT., AIM INSERTS.
.
NDATWWRT
	BRANCH	NDATWFLAG,NDATW5
	CALL	NDATWOPEN
NDATW5
	trap	IOMssg giving Error if IO
	FILEPI	1;NDATWFLIST
	WRITE	NDATWFLIST;NDATWVARS
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NDATWUPD
. REQUIRED    : A PREVIOUS KEY READ
. RETURNED    :
. DESCRIPTION : KEY UPDATE RECORD
.
NDATWUPD
	BRANCH	NDATWFLAG,NDATW6
	CALL	NDATWOPEN
NDATW6
	trap	IOMssg giving Error if IO
	FILEPI	1;NDATWFLIST
	UPDATE	NDATWFLIST;NDATWVARS
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NDATWDEL
. REQUIRED    : 'NDATWPATH', 'NDATWFLD'
. RETURNED    :
. DESCRIPTION : PATH=1 DELETES TXT & ISAM KEYS.
.
NDATWDEL
	BRANCH	NDATWFLAG,NDATW7
	CALL	NDATWOPEN
NDATW7
	trap	IOMssg giving Error if IO
	FILEPI	1;NDATWFLIST
	DELETE	NDATWFLIST
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NDATWKP
. REQUIRED    : 'NDATWPATH'
. RETURNED    : NDATWVARS
. DESCRIPTION : KEY SEQUENTIAL prior DATACARD FILE READ
.
NDATWKP
	BRANCH	NDATWPATH,NDATW8,NDATW8X
NDATW8
	BRANCH	NDATWFLAG,NDATW8A
	CALL	NDATWOPEN
NDATW8A
	BRANCH	NDATWLOCK,NDATW8AL,NDATW8AR,NDATW8AN
NDATW8AL
	trap	IOMssg giving Error if IO
	FILEPI	1;NDATWFILE
	READKP	NDATWFILE;NDATWVARS
	GOTO NDATW8X
NDATW8AR
	trap	IOMssg giving Error if IO
	READKPLK NDATWFILE;NDATWVARS
	GOTO NDATW8X
NDATW8AN
	trap	IOMssg giving Error if IO
	READKP	NDATWFILE;NDATWVARS
	GOTO NDATW8X
NDATW8X
	trapclr	IO
	RETURN
...............................................................................
.
. ENTRY POINT : NDATWOPEN
. REQUIRED    : 'NDATWPATH', 'NDATWFLAG'
. RETURNED    : 'NDATWFLAG' SET TO THE PATH NUMBER: 'NDATWPATH', IF OPENED.
. DESCRIPTION : OPEN NIN NINDATW FILE, DEPENDENT ON PATH NUMBER.
.               DISPLAY ERROR AND ABORT IF NOT ON-LINE.
.
NDATWOPEN
	move	NDATWNME1,NDATWNAME
	TRAP	NDATWGONE IF IO
	BRANCH	NDATWLOCK,NDATWOPENl,NDATWOPENr
NDATWOPENl
	OPEN	NDATWFLIST
	TRAPCLR	IO
	MOVE	C1,NDATWFLAG
	RETURN
NDATWOPENr
	OPEN	NDATWFLIST,LOCKMANUAL,SINGLE
	TRAPCLR	IO
	MOVE	C1,NDATWFLAG
	RETURN
NDATWGONE
	MOVE	NDATWNAME,FILENAME
	CALL	FILEGONE
