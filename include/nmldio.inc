..............................................................................
.
. NMLDIO INCLUSION
. NINORD MAIL DATE LOG FILE
.
. FILE NAME : NINMLD
.
..............................................................................
.
..............................................................................
.
. ENTRY POINT : NMLDKEY
. REQUIRED    : NMLDFLD
. RETURNED    : NMLDVARS
. DESCRIPTION : ISI KEY READ
.
NMLDKEY	BRANCH	NMLDPATH,NMLD1A,NMLDERR
NMLD1A	BRANCH	NMLDFLAG,NMLD1B
	CALL	NMLDOPEN
NMLD1B	TRAP	IOMssg Giving Error if IO
	branch	NMLDLOCK,NMLD1BL,NMLD1BR,NMLD1BN
NMLD1BL
.	FILEPI	1;NMLDFILE
	READ	NMLDFILE,NMLDFLD;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD1BR  
	READLK	NMLDFILE,NMLDFLD;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD1BN
	READ	NMLDFILE,NMLDFLD;NMLDVARS
	TRAPCLR	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NMLDTST
. REQUIRED    : NMLDFLD
. RETURNED    :
. DESCRIPTION : TEST KEY
.
NMLDTST	BRANCH	NMLDPATH,NMLD2A,NMLDERR
NMLD2A	BRANCH	NMLDFLAG,NMLD2B
	CALL	NMLDOPEN
NMLD2B	TRAP	IOMssg Giving Error if IO
	READ	NMLDFILE,NMLDFLD;;
	TRAPCLR	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NMLDKS
. REQUIRED    :
. RETURNED    : RECORD NUMBER RECORD
. DESCRIPTION : KEY SEQUENTIAL RECORD NUMBER FILE READ
.
NMLDKS	BRANCH	NMLDPATH,NMLD3A,NMLDerr
NMLD3A	BRANCH	NMLDFLAG,NMLD3B
	CALL	NMLDOPEN
NMLD3B	TRAP	IOMssg Giving Error if IO
	BRANCH	NMLDLOCK,NMLD3bL,NMLD3bR,NMLD3bN
NMLD3bL
.	FILEPI	1;NMLDFILE
	READKS	NMLDFILE;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD3bR
	READKSLK NMLDFILE;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD3bN
	READKS	NMLDFILE;NMLDVARS
	TRAPCLR	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NMLDSEQ
. REQUIRED    :
. RETURNED    : RECORD NUMBER RECORD
. DESCRIPTION : SEQUENTIAL RECORD NUMBER FILE READ
.               APPLICATION'S RESPONSIBILITY TO TEST FLAGS
.
NMLDSEQ	BRANCH	NMLDFLAG,NMLD4
	CALL	NMLDOPEN
NMLD4	TRAP	IOMssg Giving Error if IO
	BRANCH	NMLDLOCK,NMLD4L,NMLD4R,NMLD4N
NMLD4L
.	FILEPI	1;NMLDFILE
	READ	NMLDFILE,SEQ;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD4R
	READLK	NMLDFILE,SEQ;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD4N
	READ	NMLDFILE,SEQ;NMLDVARS
	TRAPCLR	IO
	RETURN

..............................................................................
.
. ENTRY POINT : NMLDWRT
. REQUIRED    : 'NMLDFLD'
. RETURNED    :
. DESCRIPTION : EXACT ISAM KEY TXT/ISI INSERT
.
NMLDWRT MOVE	C1,NMLDPATH
	BRANCH	NMLDFLAG,NMLD5
	CALL	NMLDOPEN
NMLD5   TRAP	IOMssg Giving Error if IO
	FILEPI	1;NMLDFLIST
	WRITE	NMLDFLIST;NMLDVARS
	TRAPCLR	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NMLDUPD
. REQUIRED    : A PREVIOUS KEY READ
. RETURNED    :
. DESCRIPTION : KEY UPDATE RECORD NUMBER FILE
.
NMLDUPD	BRANCH	NMLDFLAG,NMLD6
	CALL	NMLDOPEN
NMLD6	TRAP	IOMssg Giving Error if IO
	FILEPI	1;NMLDFLIST
	UPDATE	NMLDFLIST;NMLDVARS
	TRAPCLR	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NMLDDEL
. REQUIRED    : 'NMLDFLD'
. RETURNED    :
. DESCRIPTION : EXACT ISAM KEY TXT/ISI DELETE
.

NMLDDEL	BRANCH	NMLDFLAG,NMLD7
	CALL	NMLDOPEN
NMLD7	BRANCH	NMLDFLAG,NMLD7A
	CALL	NMLDOPEN
NMLD7A	TRAP	IOMssg Giving Error if IO
	FILEPI	1;NMLDFLIST
	DELETE	NMLDFLIST
	TRAPCLR	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NMLDAIM
. REQUIRED    : NMLDFLD1
. RETURNED    : MAIL DATE LOG RECORD
. DESCRIPTION : AIM MAIL DATE LOG FILE READ
.               APPLICATION'S RESPONSIBILITY TO TEST FLAGS
.
NMLDAIM BRANCH	NMLDFLAG,NMLD8
	CALL	NMLDOPEN
NMLD8	TRAP	IOMssg Giving Error if IO
	BRANCH	NMLDLOCK,NMLD8L,NMLD8R,NMLD8N
NMLD8L
.	FILEPI	1;NMLDFLE2
	READ	NMLDFLE2,NMLDFLD1;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD8R
	READLK	NMLDFLE2,NMLDFLD1;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD8N
	READ	NMLDFLE2,NMLDFLD1;NMLDVARS
	TRAPCLR	IO
	RETURN

..............................................................................
.
. ENTRY POINT : NMLDKG
. REQUIRED    : VALID NEXT AIM READ
. RETURNED    : MAIL DATE LOG RECORD
. DESCRIPTION : AIM KEY GENERIC MAIL DATE LOG FILE READ
.               APPLICATION'S RESPONSIBILITY TO TEST FLAGS
.
NMLDKG	BRANCH	NMLDFLAG,NMLD9
	CALL	NMLDOPEN
NMLD9	TRAP	IOMssg Giving Error if IO
	BRANCH	NMLDLOCK,NMLD9L,NMLD9R,NMLD9N
NMLD9L  
.	FILEPI	1;NMLDFLE2
	READKG	NMLDFLE2;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD9R
	READKGLK NMLDFLE2;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD9N
	READKG	NMLDFLE2;NMLDVARS
	TRAPCLR	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NMLDKGP
. REQUIRED    : PREVIOUS VALID AIM READ
. RETURNED    : MAIL DATE LOG RECORD
. DESCRIPTION : Aim KEY GENERIC PRIOR MAIL DATE LOG FILE READ
.               APPLICATION'S RESPONSIBILITY TO TEST FLAGS
.
NMLDKGP	BRANCH	NMLDFLAG,NMLD10
	CALL	NMLDOPEN
NMLD10	TRAP	IOMssg Giving Error if IO
	BRANCH	NMLDLOCK,NMLD10L,NMLD10R,NMLD10N
NMLD10L
.	FILEPI	1;NMLDFLE2
	READKGP	NMLDFLE2;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD10R
	READKGPLK NMLDFLE2;NMLDVARS
	TRAPCLR	IO
	RETURN
NMLD10N
	READKGP	NMLDFLE2;NMLDVARS
	TRAPCLR	IO
	RETURN

...............................................................................
.
. ENTRY POINT : NMLDOPEN
. REQUIRED    : 'NMLDFLAG'
. RETURNED    : 'NMLDFLAG' SET TO '1' IF OPENNED
. DESCRIPTION : OPEN NIN RECORD NUMBER FILE
.               DISPLAY ERROR AND ABORT IF NOT ON-LINE.
.
NMLDOPEN 
	TRAP	NMLDGONE IF IO
	BRANCH	NMLDLOCK,NMLDOP1,NMLDOP1R,NMLDOP1
NMLDOP1
	OPEN	NMLDFLIST
	MOVE	C1,NMLDFLAG
	TRAPCLR	IO
	RETURN
NMLDOP1R
	OPEN	NMLDFILE,NMLDNAME,LOCKMANUAL,SINGLE
	TRAPCLR	IO
	MOVE	C1,NMLDFLAG
	RETURN
.
NMLDGONE	
	MOVE	NMLDNAME TO FILENAME
	CALL	FILEGONE
.
NMLDERR	MOVE	"invalid path",FILENAME
	CALL	FILEGONE
	TRAPCLR IO
	RETURN
.
..............................................................................

