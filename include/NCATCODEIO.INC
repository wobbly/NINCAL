.....................................................................................
.
. NCATCODEIO INCLUSION
. NIN CATEGORY CODES FILE I/O ROUTINES
.
. FILE NAME : NINCODE
. REC LENGTH: 528 FIXED
. INDEX KEY : 1-6	NCATCODENUM	(LIST NUM)
.AIMDEX KEYS: (1)	XX-XX   	XXXX
.	      (2)	XX-XX		XXXXX
.
........................................................................................
.
.
. ENTRY POINT : NCATCODEKEY
. REQUIRED    : NCATCODEFLD
. RETURNED    : CATEGORY CODES RECORD
. DESCRIPTION : EXACT ISAM KEY READ
.
NCATCODEKEY
	BRANCH	NCATCODEFLAG, NCATCODE1  // if filelist already open, don't open again
	call 	NCATCODEOPEN
NCATCODE1
	TRAP	IOMssg Giving Error if IO	// set up error trap in case read fails
.	FILEPI	1;NCATCODEFILE
	READ	NCATCODEFILE,NCATCODEFLD;NCATCODEVARS
	TRAPCLR	IO
	RETURN
........................................................................................
.
. ENTRY POINT : NCATCODETST
. REQUIRED    : NCATCODEFLD
. RETURNED    : 
. DESCRIPTION : TEST KEY
.
NCATCODETST
	BRANCH	NCATCODEFLAG, NCATCODE2  // if filelist already open, don't open again
	call 	NCATCODEOPEN
NCATCODE2
	TRAP	IOMssg Giving Error if IO	// set up error trap in case read fails
.	FILEPI	1;NCATCODEFILE
	READ	NCATCODEFILE,NCATCODEFLD;;
	TRAPCLR	IO
	RETURN
........................................................................................
.
. ENTRY POINT : NCATCODEWRT
. REQUIRED    : NCATCODEFLD
. RETURNED    : 
. DESCRIPTION : EXACT ISAM KEY TXT/ISI INSERT
.
NCATCODEWRT	
	BRANCH	NCATCODEFLAG, NCATCODE3
	CALL	NCATCODEOPEN
NCATCODE3
	TRAP	IOMssg Giving Error if IO  // in case write produces errors
	FILEPI	1;NCATCODEFILE
	WRITE 	NCATCODEFLIST;NCATCODEVARS
	TRAPCLR	IO
	RETURN
..............................................................................................
. ENTRY POINT : NCATCODEUPD
. REQUIRED    : A PREVIOUS KEY READ
. RETURNED    : 
. DESCRIPTION : KEY UPDATE CATEGORY FILE
.
NCATCODEUPD
	BRANCH 	NCATCODEFLAG, NCATCODE4
	CALL	NCATCODEOPEN
NCATCODE4
	TRAP	IOMssg Giving Error if IO
	FILEPI	1;NCATCODEFLIST
	UPDATE	NCATCODEFLIST;NCATCODEVARS
	TRAPCLR	IO
	RETURN
.
..................................................................................................
. ENTRY POINT : NCATCODEDEL
. REQUIRED    : NCATCODEFLD
. RETURNED    : 
. DESCRIPTION : EXACT ISAM KEY TXT/ISI DELETE
.
NCATCODEDEL
	BRANCH 	NCATCODEFLAG TO NCATCODE5
	CALL 	NCATCODEOPEN
NCATCODE5
	CALL 	NCATCODETST
	RETURN	IF OVER
	TRAP	IOMssg Giving Error if IO
	FILEPI	1;NCATCODEFLIST
	DELETE 	NCATCODEFLIST
	TRAPCLR	IO
	RETURN
.
....................................................................................................
. ENTRY POINT : NCATCODEAIM
. REQUIRED    : NCATCODEFLD1,2,3,4,5,6,7,8
. RETURNED    : CATCODE RECORD
. DESCRIPTION : AIM CATCODE FILE READ
.
NCATCODEAIM
	BRANCH	NCATCODEFLAG TO NCATCODE6
	CALL	NCATCODEOPEN
NCATCODE6
	TRAP	IOMssg Giving Error if IO
.	FILEPI	1;NCATCODEFLE2
	READ	NCATCODEFLE2,NCATCODEFLD1,NCATCODEFLD2,NCATCODEFLD3,NCATCODEFLD4,NCATCODEFLD5,NCATCODEFLD6,NCATCODEFLD7,NCATCODEFLD8;NCATCODEVARS
	TRAPCLR	IO
	RETURN
.
........................................................................................................
. ENTRY POINT : NCATCODEKG
. REQUIRED    : VALID PREVIOUS AIM READ
. RETURNED    : CATCODE RECORD
. DESCRIPTION : AIM KEY GENERIC CATCODE FILE READ
.
NCATCODEKG
	BRANCH	NCATCODEFLAG TO NCATCODE7
	CALL	NCATCODEOPEN
NCATCODE7
	TRAP 	IOMssg Giving Error if IO
.	FILEPI	1;NCATCODEFLE2
	READKG	NCATCODEFLE2;NCATCODEVARS
	TRAPCLR	IO
	RETURN
.......................................................................................
.
. ENTRY POINT : NCATCODEOPEN
. REQUIRED    : 'NCATCODEFLAG'
. RETURNED    : 'NCATCODEFLAG' SET TO '1' IF OPENED
. DESCRIPTION : OPEN CATEGORY CODES FILES
.		DISPLAY ERROR AND ABORT IF NOT ONLINE
.
NCATCODEOPEN
	TRAP	NCATCODEGONE giving Error if IO
	OPEN	NCATCODEFLIST	.,EXCLUSIVE
	TRAPCLR	IO
	MOVE	C1,	NCATCODEFLAG
	RETURN
.
NCATCODEGONE
	MOVE 	NCATCODENAME, FILENAME
	CALL	FILEGONE
.
............................................................................................

