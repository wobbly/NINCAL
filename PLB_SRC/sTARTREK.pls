  
         INCLUDE   COMMON.INC
N1       FORM      "000"
N2       FORM      "000"
N3       FORM      "000"
N4       FORM      "000"
N5       FORM      "000"
N6       FORM      "000"
N7       FORM      "000"
N8       FORM      "000"
N9       FORM      "000"
N10      FORM      "000"
N11      FORM      "000"
N12      FORM      "000"
N13      FORM      "000"
N14      FORM      "000"
N15      FORM      "000"
N16      FORM      "000"
N17      FORM      "000"
N18      FORM      "000"
N19      FORM      "000"
N20      FORM      "000"
N21      FORM      "000"
N22      FORM      "000"
N23      FORM      "000"
N24      FORM      "000"
N25      FORM      "000"
N26      FORM      "000"
N27      FORM      "000"
N28      FORM      "000"
N29      FORM      "000"
N30      FORM      "000"
N31      FORM      "000"
N32      FORM      "000"
N33      FORM      "000"
N34      FORM      "000"
N35      FORM      "000"
N36      FORM      "000"
N37      FORM      "0"
N38      FORM      "0"
N39      FORM      "0"
N40      FORM      "0"
N41      FORM      "00"
N42      FORM      "00"
N43      FORM      "00"
N44      FORM      "00"
S1       DIM       10
S2       DIM       10
S3       DIM       1
N45      FORM      "00"
N46      FORM      "00"
N47      FORM      "  .000"
N48      FORM      "  .000"
N49      FORM      "10000.00"
N50      FORM      "10000.00"
N51      FORM      "3000.00"
N52      FORM      " 3000.00"
N53      FORM      "21"
N54      FORM      "21"
N55      FORM      "    .000"
N56      FORM      "    .000"
N57      FORM      "  .000"
N58      FORM      "    .000"
N59      FORM      "    .000"
N60      FORM      ".001"
N61      FORM      "200.00"
N62      FORM      "2000.00"
N63      FORM      "6000.00"
S4       INIT      "UP  "
S5       INIT      "GREEN "
N64      FORM      "     .00"
N65      FORM      "00"
N66      FORM      "   .00"
N67      FORM      "   .00"
N68      FORM      "    .00"
N69      FORM      "0"
N70      FORM      "00000"
N71      FORM      "0"
N72      FORM      "1"
N73      FORM      "  .00"
N74      FORM      "0"
N75      FORM      ".004"
N76      FORM      "0"
N77      FORM      "  .000"
N78      FORM      "  .000"
N79      FORM      "  .00"
N80      FORM      "   .00"
N81      FORM      "0"
N82      FORM      "     .00000"
N83      FORM      "   .00000"
N84      FORM      "   .00000"
N85      FORM      "   .00000"
N86      FORM      "   .00000"
N87      FORM      "   .00000"
N88      FORM      "   .00000"
N89      FORM      "   .00000"
N90      FORM      "     .00"
N91      FORM      " 5000.00"
N92      FORM      "00"
N93      FORM      "00"
N94      FORM      "00"
N95      FORM      "00"
N96      FORM      "00"
N97      FORM      "00"
N98      FORM      "00"
N99      FORM      "00"
N100     FORM      "00"
N101     FORM      "00"
N102     FORM      "00"
N103     FORM      "00"
N104     FORM      "00"
N105     FORM      "00"
N106     FORM      "     .00"
N107     FORM      "     .00"
N108     FORM      "     .00"
N109     FORM      "     .00"
N110     FORM      "     .00"
N111     FORM      "     .00"
N112     FORM      "     .00"
N113     FORM      "00"
N114     FORM      "00"
N115     FORM      "00"
N116     FORM      "00"
N117     FORM      "00"
N118     FORM      "00"
N119     FORM      "00"
N120     FORM      "00"
N121     FORM      "00"
N122     FORM      "00"
N123     FORM      "00"
N124     FORM      "00"
N125     FORM      "00"
N126     FORM      "00"
N127     FORM      "00"
N128     FORM      "00"
N129     FORM      "00"
N130     FORM      "00"
N131     FORM      "00"
N132     FORM      "00"
N133     FORM      "  .000"
N134     FORM      "00"
N135     FORM      "00"
N136     FORM      "00"
N137     FORM      "00"
N138     FORM      "0"
N139     FORM      "00"
N140     FORM      "00"
S6       DIM       7
N141     FORM      "00"
N142     FORM      "00"
S7       INIT      "-----------------------------------------"
S8       DIM       100
S9       DIM       100
S10      DIM       100
S11      DIM       100
N143     FORM      "000"
N144     FORM      "00"
S12      INIT      "*"
N145     FORM      "00"
N146     FORM      "00"
N147     FORM      "  .00"
N148     FORM      "00"
N149     FORM      "00"
N150     FORM      "00"
N151     FORM      ".0174533"
N152     FORM      "     .000000"
N153     FORM      "     .00"
N154     FORM      ".000000"
N155     FORM      "      .000000"
N156     FORM      "      .000000"
N157     FORM      "      .000000"
N158     FORM      "0"
N159     FORM      "1"
N160     FORM      ".000000"
N161     FORM      "   .000000"
N162     FORM      "   .000000"
N163     FORM      "    .00"
N164     FORM      "    .00"
N165     FORM      "    .00"
N166     FORM      "    .00"
N167     FORM      "  .000000"
N168     FORM      "  .000000"
N169     FORM      "  .000000"
N170     FORM      "  .000000"
N171     FORM      "1.331282"
N172     FORM      "-0.135143"
N173     FORM      "2.669187"
N174     FORM      "-1.660052"
N175     FORM      "2.717991"
N176     FORM      "-0.675220"
N177     FORM      "-0.007372"
N178     FORM      "0.267949"
N179     FORM      "1.732051"
N180     FORM      "0.523599"
N181     FORM      "1.570796"
N182     FORM      "57.295780"
+
         DISPLAY   *ES,*P5:5,"WELCOME TO STARTREK",*P10:20,"Designe":
                   "d by:  BOYD CAMPBELL & JOE BOLTON",*P10:22,"Pro":
                   "gramed by: BOYD CAMPBELL",*P73:1,"03/28/78",*W,*W:
                   *W,*ES,*P25:12,"DATABUS ",*HON,"  STAR TREK  ",*HOFF:
                   " 1.3.H"
X2196    CLOCK     TIME,S2
         RESET     S2,2
         LENSET    S2
         RESET     S2,1
         MOVE      S2,N148
         RESET     S2,5
         LENSET    S2
         RESET     S2,4
         MOVE      S2,N149
         RESET     S2,8
         LENSET    S2
         RESET     S2,7
         MOVE      S2,N145
         MOVE      N148,N161
         MULT      N149,N161
         MULT      N145,N161
         ADD       N159,N161
         MOVE      N148,N162
         ADD       N149,N162
         ADD       N145,N162
         DIV       N162,N161
         MOVE      N161,N160
         COMPARE   N158,N160
         GOTO      X2196 IF ZERO
..............................................................................
X2308    MOVE      "6",N38
         KEYIN     *P1:24,"SHORT, NORMAL, OR LONG VERSION? ",*+,S3,*P1:24:
                   *EL;
         CMATCH    "L",S3
         GOTO      X2408 IF EOS
..............................................................................
         GOTO      X2389 IF NOT ZERO
..............................................................................
         MOVE      "9",N38
         GOTO      X2408
******************************************************************************
X2389    CMATCH    "S",S3
         GOTO      X2408 IF NOT ZERO
..............................................................................
         MOVE      "3",N38
X2408    COMPARE   "4",N38
         GOTO      X2461 IF LESS
..............................................................................
         KEYIN     *P1:24,"EXPERT GAME? ",*+,S3,*P1:24,*EL;
         CMATCH    "Y",S3
         GOTO      X2461 IF NOT ZERO
..............................................................................
         MOVE      N159,N74
X2461    MOVE      N159,N145
X2466    CALL      X3841
         MOVE      "9",N39
         MULT      N160,N39
         MOVE      N38,N37
         CALL      X3841
         MULT      N160,N37
         COMPARE   "7",N37
         GOTO      X2524 IF LESS
..............................................................................
         MOVE      "6",N37
X2524    CALL      X3841
         COMPARE   ".05",N160
         GOTO      X2549 IF NOT LESS
..............................................................................
         MOVE      N159,N40
X2549    MOVE      N37,N34
         MULT      "10",N34
         ADD       N40,N34
         MULT      "10",N34
         ADD       N39,N34
         COMPARE   "10",N34
         GOTO      X2466 IF ZERO
..............................................................................
         ADD       N37,N41
         COMPARE   N158,N40
         GOTO      X2634 IF ZERO
..............................................................................
         ADD       N40,N44
         MOVE      N158,N40
X2634    STORE     N34 BY N145 OF N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11:
                   N12,N13,N14,N15,N16
         MOVE      N34,N146
         STORE     N146 BY N145 OF N17,N18,N19,N20,N21,N22,N23,N24,N25:
                   N26,N27,N28,N29,N30,N31,N32
         ADD       N159,N145
         COMPARE   "17",N145
         GOTO      X2466 IF NOT ZERO
..............................................................................
         MOVE      N41,N42
         COMPARE   N158,N44
         GOTO      X2917 IF NOT ZERO
..............................................................................
         MOVE      "15",N145
         CALL      X3841
         MULT      N160,N145
         ADD       N159,N145
         LOAD      N34 BY N145 OF N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11:
                   N12,N13,N14,N15,N16
         ADD       "10",N34
         STORE     N34 BY N145 OF N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11:
                   N12,N13,N14,N15,N16
         MOVE      N34,N146
         STORE     N146 BY N145 OF N17,N18,N19,N20,N21,N22,N23,N24,N25:
                   N26,N27,N28,N29,N30,N31,N32
         MOVE      N159,N44
X2917    MOVE      "15",N65
         CALL      X3841
         MULT      N160,N65
         ADD       N159,N65
         CALL      X3841
         MOVE      "500",N152
         MULT      N160,N152
         ADD       "2000",N152
         MOVE      N152,N56
         MOVE      N56,N55
         MOVE      N56,N58
         CALL      X3841
         MOVE      N41,N152
         MULT      N160,N152
         MULT      ".7",N152
         ADD       "25",N152
         MOVE      N152,N57
         ADD       N57,N58
         CALL      X5210
         MOVE      N148,N45
         MOVE      N149,N46
         CALL      X7937
         DISPLAY   *ES,*P5:5,"IT IS STARDATE - ",N56,*P5:6,"CAPTAIN":
                   ", THE ENTERPRISE IS READY TO GET UNDER WAY.",*P5:8:
                   "YOUR SECRET MISSION IS TO CLEAR THE GALAXY OF K":
                   "LINGON FORCES.",*P5:9,"YOU WILL HAVE ",N57," DA":
                   "YS TO COMPLETE YOUR MISSION,",*P10:10,"I.E. UNT":
                   "IL STARDATE - ",N58,".",*P5:11,"YOU WILL HAVE",N44:
                   " STARBASE";
         COMPARE   N159,N44
         GOTO      X3320 IF ZERO
..............................................................................
         DISPLAY   "S";
X3320    DISPLAY   " TO ASSIST YOU IN YOUR MISSION.",*P5:12,"THE EN":
                   "TERPRISE'S COMPUTER HAS BEEN PROGRAMED WITH THE":
                   " NECESSARY DATA.",*P5:13,"GOOD LUCK!",*P5:15,"OF":
                   " COURSE, SHOULD YOU FAIL YOUR MISSION, THE FEDE":
                   "RATION WILL",*P10:16,"DISAVOW ANY KNOWLEDGE OF ":
                   "YOUR ACTIONS.",*P5:18,"ENTER A SECRET PASSWORD ":
                   "FOR PHASE ENCRYPTION "
X3602    KEYIN     *P50:18,*EL,S1
         CMATCH    " ",S1
         GOTO      X8343 IF NOT EOS
..............................................................................
         BEEP
         GOTO      X3602
******************************************************************************
         TABPAGE
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
X3841    DIV       N161,N162
         ADD       N160,N162
         MULT      N161,N160
         ADD       N162,N161
         RETURN
******************************************************************************
X3862    CMOVE     "+",S12
X3866    COMPARE   N158,N84
         RETURN    IF LESS
..............................................................................
X3873    ADD       "2",N148
         MULT      "2",N149
         ADD       "3",N149
         DISPLAY   *PN149:N148,S12
         RETURN
******************************************************************************
X3916    DISPLAY   *P50:8,*EL,*L,*EL,*L,*EL,*L,*EL,*L,*EL,*L,*EL,*L:
                   *EL,*L,*EL,*L,*EL,*L,*EL,*L,*EL
         RETURN
******************************************************************************
X3943    COMPARE   N158,N90
         CALL      X5100 IF NOT ZERO
         STORE     N34 BY N65 OF N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11:
                   N12,N13,N14,N15,N16
         STORE     N34 BY N65 OF N17,N18,N19,N20,N21,N22,N23,N24,N25:
                   N26,N27,N28,N29,N30,N31,N32
         RETURN
******************************************************************************
X4029    MULT      N67,N152
         MULT      "20",N152
         SUB       N159,N33
         ADD       N33,N152
         MULT      ".05",N152
         COMPARE   N158,N152
         GOTO      X4127 IF LESS
..............................................................................
         MOVE      N152,N154
         SUB       N154,N152
         MOVE      N152,N33
         MOVE      N154,N152
         MULT      "20",N152
         MOVE      N152,N35
         ADD       N159,N35
         RETURN
******************************************************************************
X4127    ADD       ".05",N152
         MOVE      N152,N154
         ADD       N154,N152
         MOVE      N152,N33
         MOVE      N154,N152
         MOVE      "20",N35
         MULT      N35,N152
         SUB       N152,N35
         SUB       N159,N33
         RETURN
******************************************************************************
X4188    COMPARE   N158,N38
         RETURN    IF ZERO
..............................................................................
         MOVE      N158,N107
         MOVE      N158,N108
         MOVE      N158,N109
         MOVE      N158,N110
         MOVE      N158,N111
         MOVE      N158,N112
         RETURN
******************************************************************************
X4226    MOVE      N158,N146
X4231    ADD       N159,N146
         COMPARE   N146,N37
         GOTO      X4367 IF LESS
..............................................................................
         LOAD      N33 BY N146 OF N94,N96,N98,N100,N102,N104
         COMPARE   N148,N33
         GOTO      X4231 IF NOT ZERO
..............................................................................
         LOAD      N33 BY N146 OF N95,N97,N99,N101,N103,N105
         COMPARE   N149,N33
         GOTO      X4231 IF NOT ZERO
..............................................................................
X4299    STORE     N158 BY N146 OF N107,N108,N109,N110,N111,N112
         CMOVE     " ",S12
         CALL      X5402
         CALL      X3862
         SUB       N159,N38
         SUB       N159,N42
         SUB       "100",N34
         DISPLAY   *P66:6,N42
         RETURN
******************************************************************************
X4364    CALL      X5272
X4367    BEEP
         DISPLAY   *P1:24,"***ERROR 01***",*W,*W,*W,*W;
         CMOVE     " ",S12
         CALL      X5402
         RETURN
******************************************************************************
X4399    MOVE      N158,N138
X4404    ADD       N159,N138
         RESET     S6,N138
         CMOVE     S6,S12
         CMATCH    " ",S12
         GOTO      X4877 IF ZERO
..............................................................................
         LOAD      N139 BY N138 OF N92,N94,N96,N98,N100,N102,N104
         LOAD      N140 BY N138 OF N93,N95,N97,N99,N101,N103,N105
         MATCH     "UP",S4
         GOTO      X4618 IF ZERO
..............................................................................
         MATCH     "DOCKED",S5
         GOTO      X4618 IF ZERO
..............................................................................
         MOVE      N139,N148
         MOVE      N140,N149
         CALL      X6618
         COMPARE   N133,N163
         GOTO      X4618 IF NOT LESS
..............................................................................
         MOVE      "200",N152
         DIV       N163,N152
         CALL      X3916
         DISPLAY   *P50:8,"*** ENTERPRISE IN KLINGON ***",*P53:9,"**":
                   "* EXPLOSION RADIUS ***"
         CALL      X5660
X4618    COMPARE   N158,N38
         GOTO      X4842 IF ZERO
..............................................................................
         MOVE      N159,N146
X4632    ADD       N159,N146
         LOAD      N148 BY N146 OF N92,N94,N96,N98,N100,N102,N104
         COMPARE   N158,N148
         GOTO      X4833 IF ZERO
..............................................................................
         LOAD      N106 BY N146 OF N90,N107,N108,N109,N110,N111,N112
         COMPARE   N158,N106
         GOTO      X4833 IF ZERO
..............................................................................
         LOAD      N149 BY N146 OF N93,N95,N97,N99,N101,N103,N105
         MOVE      N139,N35
         MOVE      N140,N36
         CALL      X6628
         COMPARE   N133,N163
         GOTO      X4833 IF NOT LESS
..............................................................................
         BEEP
         CALL      X5272
         SUB       N159,N146
         CALL      X4299
         DISPLAY   *P1:24,*EL,*P20:24,"*** KLINGON WITHIN EXPLOSION":
                   " RADIUS OF KLINGON DESTROYED ***",*W;
         ADD       N159,N146
         RESET     S6,N146
         CMOVE     "*",S6
X4833    COMPARE   N146,N37
         GOTO      X4632 IF NOT LESS
..............................................................................
X4842    RESET     S6,N138
         CMOVE     " ",S6
         STORE     N158 BY N138 OF N92,N94,N96,N98,N100,N102,N104
X4877    MOVE      "2",N133
         COMPARE   N138,N37
         GOTO      X4404 IF NOT LESS
..............................................................................
         RESET     S6,7
         LENSET    S6
         RESET     S6,1
         MATCH     "       ",S6
         GOTO      X4399 IF NOT ZERO
..............................................................................
         RETURN
******************************************************************************
X4931    MOVE      N158,N146
X4936    ADD       N159,N146
         COMPARE   N146,N39
         GOTO      X4364 IF LESS
..............................................................................
         LOAD      N33 BY N146 OF N113,N115,N117,N119,N121,N123,N125:
                   N127,N129
         COMPARE   N33,N148
         GOTO      X4936 IF NOT ZERO
..............................................................................
         LOAD      N33 BY N146 OF N114,N116,N118,N120,N122,N124,N126:
                   N128,N130
         COMPARE   N33,N149
         GOTO      X4936 IF NOT ZERO
..............................................................................
         STORE     N158 BY N146 OF N113,N115,N117,N119,N121,N123,N125:
                   N127,N129
         CALL      X5272
         CMOVE     " ",S12
         CALL      X5402
         CALL      X3862
         SUB       N159,N34
         RETURN
******************************************************************************
X5059    MOVE      N90,N106
         ADD       N107,N106
         ADD       N108,N106
         ADD       N109,N106
         ADD       N110,N106
         ADD       N111,N106
         ADD       N112,N106
         DIV       N38,N106
         RETURN
******************************************************************************
X5100    MOVE      "1.5",N91
         MULT      N90,N91
         COMPARE   "500",N91
         GOTO      X5154 IF NOT LESS
..............................................................................
         ADD       "500",N91
X5154    COMPARE   "5000",N91
         GOTO      X5186 IF LESS
..............................................................................
         MOVE      "5000",N91
X5186    MOVE      N158,N90
         SUB       N159,N38
         SUB       "100",N34
         RETURN
******************************************************************************
X5210    CALL      X3841
         MOVE      "19",N148
         MULT      N160,N148
         ADD       N159,N148
         CALL      X3841
         MOVE      "19",N149
         MULT      N160,N149
         ADD       N159,N149
         CALL      X5272
         CMATCH    " ",S12
         GOTO      X5210 IF NOT ZERO
..............................................................................
         RETURN
******************************************************************************
X5272    MOVE      N148,N33
         SUB       N159,N33
         MULT      "20",N33
         ADD       N149,N33
         MOVE      N33,N143
         SUB       N159,N33
         MOVE      N33,N144
         MOVE      N144,N33
         ADD       N159,N33
         SUB       N33,N143
         MULT      ".01",N143
         BRANCH    N143 OF X5363,X5380,X5391
..............................................................................
         RESET     S8,N33
         CMOVE     S8,S12
         RETURN
******************************************************************************
X5363    RESET     S9,N33
         CMOVE     S9,S12
         RETURN
******************************************************************************
X5380    RESET     S10,N33
         CMOVE     S10,S12
         RETURN
******************************************************************************
X5391    RESET     S11,N33
         CMOVE     S11,S12
         RETURN
******************************************************************************
X5402    BRANCH    N143 OF X5418,X5424,X5430
..............................................................................
         CMOVE     S12,S8
         RETURN
******************************************************************************
X5418    CMOVE     S12,S9
         RETURN
******************************************************************************
X5424    CMOVE     S12,S10
         RETURN
******************************************************************************
X5430    CMOVE     S12,S11
         RETURN
******************************************************************************
X5436    MOVE      N60,N152
X5441    ADD       N152,N56
         SUB       N152,N57
         COMPARE   N158,N71
         CALL      X7237 IF NOT ZERO
         COMPARE   "14",N150
         GOTO      X5487 IF NOT ZERO
..............................................................................
         MOVE      "2",N152
X5487    MATCH     "DOCKED",S5
         GOTO      X5521 IF NOT ZERO
..............................................................................
         MULT      "1.5",N152
X5521    CALL      X5537
         DISPLAY   *P61:5,N56,*P72:5,N57
         RETURN
******************************************************************************
X5537    MOVE      "7",N146
X5548    LOAD      N82 BY N146 OF N83,N84,N85,N86,N87,N88,N89
         COMPARE   N158,N82
         GOTO      X5616 IF ZERO
..............................................................................
         ADD       N152,N82
         COMPARE   N158,N82
         GOTO      X5596 IF LESS
..............................................................................
         MOVE      N158,N82
X5596    STORE     N82 BY N146 OF N83,N84,N85,N86,N87,N88,N89
X5616    SUB       N159,N146
         GOTO      X5548 IF NOT ZERO
..............................................................................
         RETURN
******************************************************************************
X5626    CALL      X3916
         DISPLAY   *P55:9,"*** CRITICAL HIT ***"
X5660    BEEP
         CALL      X3841
         MOVE      "6",N146
         MULT      N160,N146
         ADD       N159,N146
X5685    LOAD      N82 BY N146 OF N83,N84,N85,N86,N87,N88,N89
         MOVE      N152,N157
         DIV       "200",N157
         ADD       N160,N157
         SUB       N157,N82
         STORE     N82 BY N146 OF N83,N84,N85,N86,N87,N88,N89
         BRANCH    N146 OF X5809,X5835,X5869,X5908,X5937,X5964,X6001
..............................................................................
         DISPLAY   *P1:24,"***ERROR IN DEVICE SELECT ***",*W,*W,*W;
         RETURN
******************************************************************************
X5809    DISPLAY   *P55:11,"WARP ENGINES DAMAGED"
         RETURN
******************************************************************************
X5835    DISPLAY   *P51:11,"SHORT RANGE SENSORS DISABLED"
         RETURN
******************************************************************************
X5869    DISPLAY   *P51:11,"LONG RANGE SENSORS DISABLED"
         RETURN
******************************************************************************
X5908    DISPLAY   *P53:11,"PHASER CONTROL DISABLED"
         RETURN
******************************************************************************
X5937    DISPLAY   *P54:11,"TORPEDO TUBES DAMAGED"
         RETURN
******************************************************************************
X5964    DISPLAY   *P50:11,"DAMAGE CONTROL DOES NOT RESPOND"
         RETURN
******************************************************************************
X6001    MOVE      "DOWN",S4
         DISPLAY   *P53:11,"ENERGY SHIELDS DISABLED",*P69:3,S4
         RETURN
******************************************************************************
X6050    DIV       "360",N152
         ADD       "10",N152
         MOVE      N152,N154
         MOVE      N154,N152
         MULT      "360",N152
         MOVE      N159,N76
         COMPARE   "180",N152
         GOTO      X6150 IF LESS
..............................................................................
         SUB       "180",N152
         MOVE      "3",N76
X6150    COMPARE   "90",N152
         GOTO      X6196 IF LESS
..............................................................................
         SUB       "180",N152
         MULT      "-1",N152
         ADD       N159,N76
X6196    MULT      N151,N152
         CALL      X6281
         COMPARE   "3",N76
         GOTO      X6231 IF NOT LESS
..............................................................................
         MULT      "-1",N157
X6231    MOVE      N157,N78
         CALL      X6419
         COMPARE   N159,N76
         GOTO      X6275 IF ZERO
..............................................................................
         COMPARE   "4",N76
         GOTO      X6275 IF ZERO
..............................................................................
         MULT      "-1",N157
X6275    MOVE      N157,N77
         RETURN
******************************************************************************
X6281    MOVE      N152,N157
         MOVE      N152,N155
         MULT      N155,N152
         MULT      N152,N155
         MOVE      N155,N156
         DIV       "6.0",N156
         SUB       N156,N157
         MULT      N152,N155
         MOVE      N155,N156
         DIV       "120.0",N156
         ADD       N156,N157
         MULT      N152,N155
         MOVE      N155,N156
         DIV       "5040.0",N156
         SUB       N156,N157
         MULT      N152,N155
         DIV       "362880.",N155
         ADD       N155,N157
         RETURN
******************************************************************************
X6419    MOVE      "1.0",N157
         MOVE      N152,N155
         MOVE      N155,N156
         DIV       "2.0",N156
         SUB       N156,N157
         MULT      N152,N155
         MOVE      N155,N156
         DIV       "24.0",N156
         ADD       N156,N157
         MULT      N152,N155
         MOVE      N155,N156
         DIV       "720.0",N156
         SUB       N156,N157
         MULT      N152,N155
         DIV       "40320.0",N155
         ADD       N155,N157
         RETURN
******************************************************************************
X6547    MOVE      N166,N163
         MULT      ".5",N163
         MOVE      "-9",N165
X6576    COMPARE   N163,N165
         RETURN    IF ZERO
..............................................................................
         MOVE      N163,N165
         MOVE      N166,N164
         DIV       N163,N164
         ADD       N164,N163
         MULT      ".5",N163
         GOTO      X6576
******************************************************************************
X6618    MOVE      N45,N35
         MOVE      N46,N36
X6628    SUB       N148,N35
         SUB       N149,N36
         MULT      N35,N35
         MULT      N36,N36
         ADD       N35,N36
         MOVE      N36,N166
         CALL      X6547
         RETURN
******************************************************************************
X6668    CALL      X6618
         MOVE      N163,N166
         CALL      X6547
         MULT      "1.5",N64
         DIV       N163,N64
         RETURN
******************************************************************************
X6698    COMPARE   N158,N40
         GOTO      X6851 IF ZERO
..............................................................................
         MOVE      N45,N148
         MOVE      N46,N149
         SUB       N141,N148
         SUB       N142,N149
         COMPARE   N158,N148
         GOTO      X6748 IF NOT LESS
..............................................................................
         MULT      "-1",N148
X6748    COMPARE   N158,N149
         GOTO      X6769 IF NOT LESS
..............................................................................
         MULT      "-1",N149
X6769    COMPARE   "2",N148
         GOTO      X6851 IF NOT LESS
..............................................................................
         COMPARE   "2",N149
         GOTO      X6851 IF NOT LESS
..............................................................................
         MOVE      N49,N50
         MOVE      N53,N54
         MOVE      N51,N52
         MOVE      "DOCKED",S5
         DISPLAY   *P58:2,N50,*P78:2,N54,*P58:3,N52
         GOTO      X6944
******************************************************************************
X6851    MOVE      "RED   ",S5
         COMPARE   N158,N38
         GOTO      X6944 IF NOT ZERO
..............................................................................
         MOVE      "YELLOW",S5
         COMPARE   "2000",N50
         GOTO      X6944 IF LESS
..............................................................................
         COMPARE   N158,N65
         GOTO      X6944 IF ZERO
..............................................................................
         MOVE      "GREEN ",S5
X6944    DISPLAY   *P62:4,S5
         RETURN
******************************************************************************
X6952    COMPARE   "-1",N73
         GOTO      X6973 IF NOT ZERO
..............................................................................
         MOVE      N158,N73
X6973    ADD       ".3",N73
         RETURN
******************************************************************************
X6986    COMPARE   N158,N152
         GOTO      X7007 IF NOT LESS
..............................................................................
         MULT      "-1",N152
X7007    MOVE      N152,N167
         MOVE      N158,N152
         COMPARE   N159,N167
         GOTO      X7046 IF LESS
..............................................................................
         MOVE      N159,N168
         DIV       N167,N168
         MOVE      N168,N167
         MOVE      N181,N152
X7046    COMPARE   N167,N178
         GOTO      X7099 IF NOT LESS
..............................................................................
         MOVE      N167,N168
         MULT      N179,N167
         SUB       N159,N167
         ADD       N179,N168
         DIV       N168,N167
         COMPARE   N158,N152
         GOTO      X7094 IF ZERO
..............................................................................
         MOVE      N180,N152
X7094    ADD       N180,N152
X7099    MOVE      N167,N168
         MULT      N168,N168
         MOVE      N168,N169
         ADD       N171,N169
         MOVE      N172,N170
         DIV       N169,N170
         ADD       N173,N170
         ADD       N168,N170
         MOVE      N174,N169
         DIV       N170,N169
         ADD       N175,N169
         ADD       N168,N169
         MOVE      N176,N170
         DIV       N169,N170
         ADD       N177,N170
         MULT      N168,N170
         MULT      N167,N170
         ADD       N167,N170
         COMPARE   N158,N152
         GOTO      X7231 IF ZERO
..............................................................................
         COMPARE   N180,N152
         GOTO      X7226 IF ZERO
..............................................................................
         SUB       N170,N152
         MOVE      N152,N170
         GOTO      X7231
******************************************************************************
X7226    ADD       N152,N170
X7231    MULT      N182,N170
         RETURN
******************************************************************************
X7237    MOVE      N152,N157
         MULT      "1000",N157
         SUB       N157,N50
         DISPLAY   *P58:2,N50
         CALL      X3841
         COMPARE   ".85",N160
         GOTO      X7357 IF NOT LESS
..............................................................................
         COMPARE   "1500",N50
         RETURN    IF NOT LESS
..............................................................................
         BEEP
         DISPLAY   *P1:24,*EL,*P40:24,"ENERGY TOO LOW TO MAINTAIN C":
                   "LOAK",*W,*P1:24,*EL;
         MOVE      N158,N71
         RETURN
******************************************************************************
X7357    BEEP
         MOVE      N159,N157
         SUB       N160,N157
         MULT      N157,N50
         MOVE      N158,N72
         MOVE      N72,N71
         DISPLAY   *P1:24,*EL,*P10:24,"*** CLOAKING DEVICE IMPLODES":
                   ", DRAINING SHIP'S ENERGY ***",*W,*P58:2,N50,*W,*W:
                   *P1:24,*EL;
         RETURN
******************************************************************************
X7467    BEEP
         DISPLAY   *P1:24,*EL,*P5:24,"SIR! MYSTERIOUS POWER DRAIN A":
                   "FFECTING SHIP'S POWER SUPPLY!",*W;
         CALL      X3841
         MOVE      "750",N152
         MULT      N160,N152
         SUB       N152,N50
         DISPLAY   *P58:2,N50,*W,*P1:24,*EL;
         ADD       "20",N70
         RETURN
******************************************************************************
X7587    MOVE      N158,N76
         COMPARE   N79,N67
         GOTO      X9781 IF LESS
..............................................................................
         ADD       "3",N79
         COMPARE   N67,N79
         GOTO      X9781 IF LESS
..............................................................................
         SUB       "2.5",N80
         COMPARE   N80,N68
         GOTO      X9781 IF LESS
..............................................................................
         ADD       "5",N80
         COMPARE   N68,N80
         GOTO      X9781 IF LESS
..............................................................................
         COMPARE   N81,N66
         GOTO      X9781 IF NOT ZERO
..............................................................................
         MOVE      "16",N152
         CALL      X3841
         MULT      N160,N152
         MOVE      N152,N65
         MOVE      N158,N33
         MOVE      N159,N76
         GOTO      X9781
******************************************************************************
         TABPAGE
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
X7937    LOAD      N34 BY N65 OF N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11:
                   N12,N13,N14,N15,N16
         MOVE      N34,N39
         MOVE      N34,N33
         DIV       "10",N33
         MOVE      N33,N40
         DIV       "10",N33
         MOVE      N33,N37
         MOVE      N37,N38
         MOVE      "100",N33
         RESET     S8,N33
         LENSET    S8
         RESET     S8,1
         REPLACE   "E * K B C ",S8
         MOVE      S8,S9
         MOVE      S8,S10
         MOVE      S8,S11
         MOVE      N45,N148
         MOVE      N46,N149
         CALL      X5272
         CMOVE     "E",S12
         CALL      X5402
         MOVE      "-1",N73
         COMPARE   N158,N40
         GOTO      X8146 IF ZERO
..............................................................................
         CALL      X5210
         MOVE      N148,N141
         MOVE      N149,N142
         CMOVE     "B",S12
         CALL      X5402
X8146    MOVE      N37,N145
         GOTO      X8268 IF ZERO
..............................................................................
X8155    CALL      X5210
         STORE     N148 BY N145 OF N94,N96,N98,N100,N102,N104
         STORE     N149 BY N145 OF N95,N97,N99,N101,N103,N105
         CMOVE     "K",S12
         CALL      X5402
         MOVE      "300",N106
         CALL      X3841
         MULT      N160,N106
         ADD       "300",N106
         STORE     N106 BY N145 OF N107,N108,N109,N110,N111,N112
         SUB       N159,N145
         GOTO      X8155 IF NOT ZERO
..............................................................................
X8268    MOVE      N39,N145
         RETURN    IF ZERO
..............................................................................
X8275    CALL      X5210
         STORE     N148 BY N145 OF N113,N115,N117,N119,N121,N123,N125:
                   N127,N129
         STORE     N149 BY N145 OF N114,N116,N118,N120,N122,N124,N126:
                   N128,N130
         CMOVE     "*",S12
         CALL      X5402
         SUB       N159,N145
         GOTO      X8275 IF NOT ZERO
..............................................................................
         RETURN
******************************************************************************
X8343    CALL      X5436
         SUB       "10",N50
         DISPLAY   *ES,*P5:1,"1 2 3 4 5 6 7 8 910 1 2 3 4 5 6 7 8 9":
                   "20",*P4:2,S7
         MOVE      "2",N146
         MOVE      N158,N145
X8424    ADD       N159,N145
         ADD       N159,N146
         DISPLAY   *P1:N146,N145,"|",*P45:N146,"|"
         COMPARE   "20",N145
         GOTO      X8424 IF NOT ZERO
..............................................................................
         DISPLAY   *P4:23,S7
         COMPARE   N158,N84
         GOTO      X8542 IF NOT LESS
..............................................................................
         COMPARE   "2",N150
         GOTO      X8769 IF NOT ZERO
..............................................................................
         DISPLAY   *P40:24,"SHORT RANGE SENSORS DAMAGED, SIR!";
         GOTO      X8769
******************************************************************************
X8542    CMOVE     "E",S12
         MOVE      N45,N148
         MOVE      N46,N149
         CALL      X3873
         COMPARE   N158,N40
         GOTO      X8585 IF ZERO
..............................................................................
         CMOVE     "B",S12
         MOVE      N141,N148
         MOVE      N142,N149
         CALL      X3873
X8585    COMPARE   N158,N90
         GOTO      X8611 IF ZERO
..............................................................................
         CMOVE     "C",S12
         MOVE      N92,N148
         MOVE      N93,N149
         CALL      X3873
X8611    MOVE      N37,N145
         GOTO      X8681 IF ZERO
..............................................................................
         CMOVE     "K",S12
X8624    LOAD      N148 BY N145 OF N94,N96,N98,N100,N102,N104
         COMPARE   N158,N148
         GOTO      X8672 IF ZERO
..............................................................................
         LOAD      N149 BY N145 OF N95,N97,N99,N101,N103,N105
         CALL      X3873
X8672    SUB       N159,N145
         GOTO      X8624 IF NOT ZERO
..............................................................................
X8681    MOVE      N39,N145
         GOTO      X8769 IF ZERO
..............................................................................
         CMOVE     "*",S12
X8694    LOAD      N148 BY N145 OF N113,N115,N117,N119,N121,N123,N125:
                   N127,N129
         COMPARE   N158,N148
         GOTO      X8760 IF ZERO
..............................................................................
         LOAD      N149 BY N145 OF N114,N116,N118,N120,N122,N124,N126:
                   N128,N130
         CALL      X3873
X8760    SUB       N159,N145
         GOTO      X8694 IF NOT ZERO
..............................................................................
X8769    DISPLAY   *P50:1,"QUADRANT - ",N65,"  SECTOR  (",N46,",",N45:
                   ")",*P50:2,"ENERGY  ",N50,"  TORPEDOES ",N54,*P50:3:
                   "SHIELDS ",N52," - ",S4,*P50:4,"CONDITION - ",*P50:5:
                   "STARDATE - ",N56,"  (",N57,")",*P50:6,"KLINGONS":
                   " LEFT - ",N42
         CALL      X6698
         COMPARE   "2",N150
         GOTO      X8943 IF NOT ZERO
..............................................................................
X8925    COMPARE   N158,N74
         GOTO      X8946 IF ZERO
..............................................................................
         COMPARE   N59,N56
         GOTO      X8946 IF LESS
..............................................................................
X8943    CALL      X18444
X8946    COMPARE   N61,N50
         GOTO      X19827 IF LESS
..............................................................................
         COMPARE   N58,N56
         GOTO      X19827 IF NOT LESS
..............................................................................
         CALL      X6698
         COMPARE   N158,N42
         GOTO      X20282 IF ZERO
..............................................................................
         COMPARE   N158,N65
         CALL      X7467 IF ZERO
X8991    KEYIN     *P1:24,"ORDERS, SIR? ",N150,*P1:24,*EL;
         ADD       N159,N150
         GOTO      X20802 IF OVER
..............................................................................
         BRANCH    N150 OF X9099,X8343,X10629,X10979,X11714,X13975,X14261:
                   X14689,X15641,X15887,X16026,X16428,X16880,X17173:
                   X17203,X17926,X20719
..............................................................................
X9062    BEEP
         DISPLAY   *P40:24,*EL,"INPUT ILLOGICAL";
X9084    ADD       "10",N70
         GOTO      X8925
******************************************************************************
X9099    COMPARE   N158,N83
         GOTO      X9140 IF NOT LESS
..............................................................................
         DISPLAY   *P40:24,"WARP DRIVE DAMAGED, SIR!";
         GOTO      X8925
******************************************************************************
X9140    KEYIN     *P1:24,"BEARING? ",N68,*P20:24,"DISTANCE? ",N67,*P40:24:
                   "WARP FACTOR? ",N66,*P1:24,*EL;
         COMPARE   N158,N66
         GOTO      X8925 IF ZERO
..............................................................................
         COMPARE   N158,N67
         GOTO      X8925 IF ZERO
..............................................................................
         COMPARE   ".25",N67
         GOTO      X9062 IF LESS
..............................................................................
         COMPARE   "16.01",N67
         GOTO      X9062 IF NOT LESS
..............................................................................
         COMPARE   "1.00",N66
         GOTO      X9062 IF LESS
..............................................................................
         COMPARE   "9.01",N66
         GOTO      X9062 IF NOT LESS
..............................................................................
         MOVE      N67,N152
         MULT      "4",N152
         COMPARE   N66,N152
         GOTO      X9377 IF NOT LESS
..............................................................................
         DISPLAY   *P22:24,"INSUFFICIENT DISTANCE TO ACHIEVE THAT W":
                   "ARP FACTOR, SIR!";
         GOTO      X8925
******************************************************************************
X9377    MOVE      N68,N152
         CALL      X6050
         MOVE      N66,N152
         MULT      N66,N152
         MULT      "4",N152
         MULT      N67,N152
         ADD       "500",N152
         COMPARE   N50,N152
         GOTO      X9473 IF LESS
..............................................................................
         BEEP
         DISPLAY   *P40:24,"INSUFFICIENT ENERGY, SIR!";
         GOTO      X8925
******************************************************************************
X9473    SUB       "500",N152
         SUB       N152,N50
         DISPLAY   *P58:2,N50
         COMPARE   N158,N65
         GOTO      X7587 IF ZERO
..............................................................................
         CALL      X18444
         MOVE      N67,N152
         DIV       N66,N152
         CALL      X5441
         MOVE      N158,N73
         MOVE      N159,N76
         MOVE      N158,N147
         MOVE      N45,N47
         MOVE      N46,N48
         MOVE      N45,N148
         MOVE      N46,N149
         CALL      X5272
         CMOVE     " ",S12
         CALL      X5402
         CALL      X3866
X9571    ADD       N78,N47
         ADD       N77,N48
         COMPARE   ".6",N47
         GOTO      X9908 IF LESS
..............................................................................
         COMPARE   "20.4",N47
         GOTO      X9958 IF NOT LESS
..............................................................................
         COMPARE   ".6",N48
         GOTO      X9747 IF LESS
..............................................................................
         COMPARE   "20.4",N48
         GOTO      X9747 IF NOT LESS
..............................................................................
         MOVE      N47,N148
         MOVE      N48,N149
         CALL      X5272
         CMATCH    " ",S12
         GOTO      X10060 IF NOT ZERO
..............................................................................
X9670    ADD       ".05",N147
         COMPARE   N67,N147
         GOTO      X9571 IF LESS
..............................................................................
X9692    MOVE      N47,N45
         MOVE      N45,N148
         MOVE      N48,N46
         MOVE      N46,N149
         CALL      X5272
         CMOVE     "E",S12
         CALL      X5402
         CALL      X3866
         DISPLAY   *P74:1,N46,",",N45
         CALL      X18433
         GOTO      X8925
******************************************************************************
X9747    CALL      X3943
         MOVE      N78,N152
         MOVE      N45,N33
         CALL      X4029
         MOVE      N35,N45
         COMPARE   N158,N33
         GOTO      X9908 IF LESS
..............................................................................
         GOTO      X9958 IF NOT ZERO
..............................................................................
X9781    COMPARE   N158,N76
         GOTO      X9901 IF ZERO
..............................................................................
         MOVE      N77,N152
         MOVE      N46,N33
         CALL      X4029
         MOVE      N35,N46
         ADD       N65,N33
         COMPARE   N159,N33
         GOTO      X9834 IF NOT LESS
..............................................................................
         ADD       "16",N33
X9834    COMPARE   "17",N33
         GOTO      X9862 IF LESS
..............................................................................
         SUB       "16",N33
X9862    MOVE      N33,N65
         DISPLAY   *P40:24,"SCANNING QUADRANT ",N65,", SIR!";
         CALL      X4188
X9901    CALL      X7937
         BEEP
         GOTO      X8343
******************************************************************************
X9908    COMPARE   "9",N65
         GOTO      X9994 IF LESS
..............................................................................
         MOVE      "8",N152
X9934    CALL      X3943
         CALL      X3841
         MULT      N160,N152
         MOVE      N152,N65
         MOVE      N158,N33
         GOTO      X9781
******************************************************************************
X9958    COMPARE   "9",N65
         GOTO      X9994 IF NOT LESS
..............................................................................
         MOVE      "-8",N152
         GOTO      X9934
******************************************************************************
X9994    BEEP
         CALL      X3943
         MOVE      N158,N34
         MOVE      N34,N65
         DISPLAY   *P10:24,"*** ENTERPRISE LEAVING GALAXY ***",*W,*W;
         CALL      X4188
         CALL      X7937
         CALL      X18433
         GOTO      X8343
******************************************************************************
X10060   BEEP
         ADD       "25",N70
         CMATCH    "*",S12
         GOTO      X10195 IF ZERO
..............................................................................
         ADD       "50",N70
         CMATCH    "B",S12
         GOTO      X10261 IF ZERO
..............................................................................
         SUB       "25",N70
         CMATCH    "K",S12
         GOTO      X10311 IF ZERO
..............................................................................
         CMATCH    "C",S12
         GOTO      X10556 IF ZERO
..............................................................................
         SUB       "50",N70
         DISPLAY   *P30:24,"***ERROR 02*** - CHAR = ",S12,*W,*W,*W,*W;
         CMOVE     " ",S12
         CALL      X5402
         COMPARE   N159,N150
         GOTO      X9670 IF ZERO
..............................................................................
         GOTO      X16792
******************************************************************************
X10195   DISPLAY   *P25:24,"ENTERPRISE BLOCKED BY STAR AT SECTOR ",N149:
                   ",",N148;
         SUB       N78,N47
         SUB       N77,N48
         GOTO      X9692
******************************************************************************
X10261   DISPLAY   *P25:24,"*** ENTERPRISE RAMS STARBASE ***";
         SUB       N78,N47
         SUB       N77,N48
         GOTO      X10608
******************************************************************************
X10311   DISPLAY   *P25:24,"ENTERPRISE RAMS KLINGON AT SECTOR ",N149:
                   ",",N148,*W,*P1:24,*EL,*P40:24,"*** KLINGON DEST":
                   "ROYED IN COLLISION ***";
         CALL      X4226
         STORE     "0" BY N146 OF N94,N96,N98,N100,N102,N104
         MOVE      "50",N152
         MULT      N66,N152
X10445   CALL      X3916
         DISPLAY   *P53:8,*W,"SIR, REPORTS ARRIVING ON",*P50:9,"DAM":
                   "AGE SUSTAINED IN COLLISION!";
         MOVE      N159,N146
X10522   BEEP
         CALL      X5685
         ADD       N159,N146
         COMPARE   "8",N146
         GOTO      X9692 IF NOT LESS
..............................................................................
         DISPLAY   *P50:11,*W,*EL
         GOTO      X10522
******************************************************************************
X10556   DISPLAY   *P30:24,"*** ENTERPRISE RAMS KLINGON COMMAND SHI":
                   "P ***";
         CALL      X5100
X10608   MOVE      "100",N152
         MULT      N66,N152
         GOTO      X10445
******************************************************************************
X10629   CALL      X5436
         COMPARE   N158,N85
         GOTO      X10681 IF NOT LESS
..............................................................................
         DISPLAY   *P40:24,"LONG RANGE SENSORS DAMAGED, SIR!";
         GOTO      X8925
******************************************************************************
X10681   SUB       "10",N50
         DISPLAY   *P58:2,N50,*P53:20,"LONG RANGE SENSOR SCAN"
         MOVE      N158,N36
         MOVE      N36,N35
         COMPARE   N158,N65
         GOTO      X10911 IF ZERO
..............................................................................
         COMPARE   N158,N71
         CALL      X6952 IF NOT ZERO
         LOAD      N35 BY N65 OF N16,N1,N2,N3,N4,N5,N6,N7,N8,N9,N10:
                   N11,N12,N13,N14,N15
         STORE     N35 BY N65 OF N32,N17,N18,N19,N20,N21,N22,N23,N24:
                   N25,N26,N27,N28,N29,N30,N31
         LOAD      N36 BY N65 OF N2,N3,N4,N5,N6,N7,N8,N9,N10,N11,N12:
                   N13,N14,N15,N16,N1
         STORE     N36 BY N65 OF N18,N19,N20,N21,N22,N23,N24,N25,N26:
                   N27,N28,N29,N30,N31,N32,N17
X10911   DISPLAY   *P55:21,"+-----+-----+-----+",*P55:22,"| ",N35," |":
                   " ",N34," | ",N36," |",*P55:23,"+-----+-----+---":
                   "--+"
         GOTO      X8925
******************************************************************************
X10979   CALL      X5436
         COMPARE   N158,N86
         GOTO      X11037 IF NOT LESS
..............................................................................
         DISPLAY   *P40:24,"PHASER CONTROL INOPERATIVE, SIR!";
         GOTO      X8925
******************************************************************************
X11037   KEYIN     *P1:24,"PHASERS LOCKED ON TARGET  - UNITS TO FIR":
                   "E? ",N64,*P1:24,*EL;
         COMPARE   N158,N64
         GOTO      X8925 IF ZERO
..............................................................................
         GOTO      X9062 IF LESS
..............................................................................
         COMPARE   N50,N64
         GOTO      X9062 IF NOT LESS
..............................................................................
         COMPARE   N64,N63
         GOTO      X11215 IF NOT LESS
..............................................................................
         MOVE      N64,N152
         SUB       N63,N152
         DIV       "50",N152
         ADD       N152,N70
         MULT      ".1",N152
         ADD       N160,N152
         SUB       N152,N86
         BEEP
         DISPLAY   *P40:24,"*** PHASERS OVERLOADING, SIR! ***",*W,*P1:24:
                   *EL;
X11215   COMPARE   N159,N38
         GOTO      X11239 IF NOT LESS
..............................................................................
         SUB       N64,N50
         DISPLAY   *P58:2,N50
         GOTO      X9084
******************************************************************************
X11239   MOVE      N64,N153
         DIV       N38,N153
         MOVE      N158,N145
X11254   ADD       N159,N145
         LOAD      N106 BY N145 OF N90,N107,N108,N109,N110,N111,N112
         COMPARE   N158,N106
         GOTO      X11702 IF ZERO
..............................................................................
         LOAD      N148 BY N145 OF N92,N94,N96,N98,N100,N102,N104
         LOAD      N149 BY N145 OF N93,N95,N97,N99,N101,N103,N105
         COMPARE   N158,N71
         CALL      X6952 IF NOT ZERO
         MOVE      N153,N64
         SUB       N64,N50
         CALL      X6668
         BEEP
         DISPLAY   *P58:2,N50,*P1:24,*EL,"** ",N64," UNIT HIT ON KL":
                   "INGON AT SECTOR - ",N149,",",N148," **",*W;
         SUB       N64,N106
         DISPLAY   *P1:24,*EL,"      ",N106," UNITS LEFT",*W,*P1:24:
                   *EL;
         COMPARE   ".01",N106
         GOTO      X11673 IF NOT LESS
..............................................................................
         BEEP
         CALL      X5272
         CMOVE     " ",S12
         CALL      X5402
         SUB       N159,N38
         MOVE      N148,N139
         MOVE      N149,N140
         MOVE      "2",N133
         COMPARE   N159,N145
         GOTO      X11538 IF NOT ZERO
..............................................................................
         MOVE      N158,N91
         MOVE      "3",N133
         GOTO      X11543
******************************************************************************
X11538   SUB       N159,N42
X11543   SUB       "100",N34
         DISPLAY   *P4:24,"*** KLINGON AT SECTOR ",N149,",",N148," ";
         COMPARE   "-499",N106
         GOTO      X11625 IF LESS
..............................................................................
         DISPLAY   "DESTROYED";
         CMOVE     "+",S12
         GOTO      X11640
******************************************************************************
X11625   DISPLAY   "VAPORIZED";
         CMOVE     " ",S12
X11640   DISPLAY   " ***",*P66:6,N42,*W,*P1:24,*EL;
         CALL      X3866
         RESET     S6,N145
         CMOVE     "*",S6
         MOVE      N158,N106
X11673   STORE     N106 BY N145 OF N90,N107,N108,N109,N110,N111,N112
         COMPARE   N158,N106
         CALL      X4399 IF ZERO
X11702   COMPARE   N145,N37
         GOTO      X11254 IF NOT LESS
..............................................................................
         GOTO      X8943
******************************************************************************
X11714   CALL      X5436
         COMPARE   N158,N87
         GOTO      X11760 IF NOT LESS
..............................................................................
         DISPLAY   *P40:24,"PHOTON TUBES DAMAGED, SIR!";
         GOTO      X8925
******************************************************************************
X11760   COMPARE   N158,N54
         GOTO      X11814 IF NOT ZERO
..............................................................................
         DISPLAY   *P40:24,"PHOTON TORPEDO BANK EMPTY, SIR!";
         GOTO      X9084
******************************************************************************
X11814   MATCH     "DOWN",S4
         GOTO      X11864 IF ZERO
..............................................................................
         DISPLAY   *P40:24,"SHIELDS ACTIVATED, SIR!";
         GOTO      X9084
******************************************************************************
X11864   KEYIN     *P40:24,"TORPEDOES BEING ENERGIZED, SIR!",*P1:24:
                   "BEARING? ",S2,*P1:24,*EL;
         CMATCH    " ",S2
         GOTO      X8925 IF EOS
..............................................................................
         TYPE      S2
         GOTO      X11864 IF NOT ZERO
..............................................................................
         MOVE      S2,N68
         GOTO      X9062 IF OVER
..............................................................................
         COMPARE   "3",N54
         GOTO      X12036 IF LESS
..............................................................................
X11957   KEYIN     *P1:24,"DO YOU WISH TO FIRE A SPREAD, SIR? ",S2,*P1:24:
                   *EL;
         CMATCH    "Y",S2
         GOTO      X12050 IF ZERO
..............................................................................
         TYPE      S2
         GOTO      X12036 IF NOT ZERO
..............................................................................
         MOVE      S2,N66
         GOTO      X11957 IF EOS
..............................................................................
         GOTO      X12082
******************************************************************************
X12036   MOVE      "2",N69
         GOTO      X12120
******************************************************************************
X12050   KEYIN     *P1:24,"SPREAD ANGLE? (0-45) ",N66,*P1:24,*EL;
X12082   COMPARE   N158,N66
         GOTO      X12050 IF LESS
..............................................................................
         COMPARE   "45.01",N66
         GOTO      X12050 IF NOT LESS
..............................................................................
         SUB       N66,N68
         MOVE      N158,N69
X12120   MOVE      N68,N152
         CALL      X6050
         SUB       N159,N54
         DISPLAY   *P78:2,N54
         MOVE      N45,N47
         MOVE      N46,N48
         MOVE      N159,N148
         MOVE      N148,N149
X12160   ADD       N78,N47
         ADD       N77,N48
         COMPARE   ".6",N47
         GOTO      X12292 IF LESS
..............................................................................
         COMPARE   "20.4",N47
         GOTO      X12292 IF NOT LESS
..............................................................................
         COMPARE   ".6",N48
         GOTO      X12292 IF LESS
..............................................................................
         COMPARE   "20.4",N48
         GOTO      X12292 IF NOT LESS
..............................................................................
         COMPARE   N158,N84
         GOTO      X12255 IF LESS
..............................................................................
         DISPLAY   *PN149:N148," "
X12255   MOVE      N47,N148
         MOVE      N48,N149
         CALL      X5272
         CMATCH    " ",S12
         GOTO      X12379 IF NOT ZERO
..............................................................................
X12276   CMOVE     ".",S12
         CALL      X3866
         GOTO      X12160
******************************************************************************
X12292   BEEP
         COMPARE   N158,N84
         GOTO      X12310 IF LESS
..............................................................................
         DISPLAY   *PN149:N148," "
X12310   DISPLAY   *P1:24,*EL,*P40:24,"*** TORPEDO MISSED ***",*W;
X12342   ADD       N159,N69
         ADD       N66,N68
         COMPARE   N158,N71
         CALL      X6952 IF NOT ZERO
         COMPARE   "3",N69
         GOTO      X12120 IF LESS
..............................................................................
         GOTO      X8943
******************************************************************************
X12379   BEEP
         CMATCH    "K",S12
         GOTO      X12459 IF ZERO
..............................................................................
         CMATCH    "C",S12
         GOTO      X12549 IF ZERO
..............................................................................
         CMATCH    "*",S12
         GOTO      X12748 IF ZERO
..............................................................................
         CMATCH    "B",S12
         GOTO      X13805 IF ZERO
..............................................................................
         BEEP
         DISPLAY   *P30:24,"***ERROR 03*** - CHAR = ",S12,*EL,*W,*W:
                   *W,*W;
         CMOVE     " ",S12
         CALL      X5402
         GOTO      X12276
******************************************************************************
X12459   CALL      X4226
         ADD       N159,N146
         RESET     S6,N146
         CMOVE     "*",S6
         DISPLAY   *P1:24,*EL,*P40:24,"*** KLINGON BATTLE CRUISER D":
                   "ESTROYED ***",*W;
         MOVE      "2",N133
         CALL      X4399
         GOTO      X12342
******************************************************************************
X12549   DISPLAY   *P1:24,*EL,*P30:24,"*** DIRECT HIT ON KLINGON CO":
                   "MMAND SHIP ***",*W;
         COMPARE   "750.01",N90
         GOTO      X12637 IF LESS
..............................................................................
         SUB       "750",N90
         GOTO      X12342
******************************************************************************
X12637   MOVE      N158,N90
         MOVE      N158,N91
         CMOVE     " ",S12
         CALL      X5402
         CALL      X3862
         SUB       N159,N38
         SUB       "100",N34
         DISPLAY   *P1:24,*EL,*P40:24,"*** KLINGON COMMAND SHIP DES":
                   "TROYED ***",*W;
         RESET     S6,1
         CMOVE     "*",S6
         MOVE      "3",N133
         CALL      X4399
         GOTO      X12342
******************************************************************************
X12748   CALL      X3841
         COMPARE   ".4",N160
         GOTO      X12822 IF LESS
..............................................................................
         DISPLAY   *P1:24,*EL,*P40:24,"*** TORPEDO IMPLODES WITHIN ":
                   "STAR ***",*W;
         GOTO      X12342
******************************************************************************
X12822   MOVE      N158,N131
X12827   DISPLAY   *P1:24,*EL,*P40:24,"*** STAR NOVA REACTION INITI":
                   "ATED ***",*W;
         MOVE      N148,N134
         MOVE      N149,N135
         COMPARE   N158,N84
         GOTO      X12960 IF LESS
..............................................................................
         CMOVE     "*",S12
         CALL      X3873
         MOVE      N158,N145
X12904   ADD       N159,N145
         COMPARE   "11",N145
         GOTO      X12960 IF NOT LESS
..............................................................................
         DISPLAY   *PN149:N148,"+",*PN149:N148,"*",*PN149:N148,"##":
                   *PN149:N148,"@",*PN149:N148,"*"
         GOTO      X12904
******************************************************************************
X12960   CALL      X3841
         COMPARE   ".5",N160
         GOTO      X12992 IF LESS
..............................................................................
         MOVE      N134,N148
         MOVE      N135,N149
         CALL      X4931
X12992   MATCH     "DOCKED",S5
         GOTO      X13215 IF ZERO
..............................................................................
         MOVE      N134,N148
         MOVE      N135,N149
         CALL      X6618
         COMPARE   "6",N163
         GOTO      X13215 IF NOT LESS
..............................................................................
         CALL      X3916
         COMPARE   "2",N163
         GOTO      X13131 IF NOT LESS
..............................................................................
         MOVE      N45,N148
         MOVE      N46,N149
         CALL      X3862
         BEEP
         DISPLAY   *P51:10,"*** ENTERPRISE DESTROYED ***",*W,*W
         ADD       "1000",N70
         GOTO      X19827
******************************************************************************
X13131   MOVE      "3000",N152
         DIV       N163,N152
         DISPLAY   *P50:8,"*** ENTERPRISE WITHIN STAR ***",*P53:9,"**":
                   "* EXPLOSION RADIUS ***"
         CALL      X5660
X13215   COMPARE   N158,N38
         GOTO      X13426 IF ZERO
..............................................................................
         MOVE      N159,N145
X13229   LOAD      N148 BY N145 OF N94,N96,N98,N100,N102,N104
         COMPARE   N158,N148
         GOTO      X13398 IF ZERO
..............................................................................
         LOAD      N149 BY N145 OF N95,N97,N99,N101,N103,N105
         MOVE      N134,N35
         MOVE      N135,N36
         CALL      X6628
         COMPARE   "6",N163
         GOTO      X13398 IF NOT LESS
..............................................................................
         CALL      X5272
         MOVE      N145,N146
         CALL      X4299
         BEEP
         DISPLAY   *P20:24,*EL,"*** KLINGON WITHIN EXPLOSION RADIUS":
                   " OF STAR DESTROYED ***",*W;
         ADD       N159,N146
         RESET     S6,N146
         CMOVE     "*",S6
X13398   ADD       N159,N145
         COMPARE   N145,N37
         GOTO      X13229 IF NOT LESS
..............................................................................
         MOVE      "2",N133
         CALL      X4399
X13426   CALL      X3841
         COMPARE   ".03",N160
         GOTO      X13614 IF NOT LESS
..............................................................................
         BEEP
         CALL      X3916
         DISPLAY   *P52:9,"THAT STAR HAD AN INHABITED",*P53:10,"PLA":
                   "NET WHICH WAS TOTALLY",*P53:11,"DESTROYED IN TH":
                   "E BLAST.",*P50:13,"THIS WILL COST YOU 1000 POIN":
                   "TS",*P53:14,"OFF YOUR RATING, TURKEY!"
         ADD       "1000",N70
X13614   MOVE      N158,N145
         MOVE      "20",N133
X13631   ADD       N159,N145
         LOAD      N148 BY N145 OF N113,N115,N117,N119,N121,N123,N125:
                   N127,N129
         COMPARE   N158,N148
         GOTO      X13757 IF ZERO
..............................................................................
         LOAD      N149 BY N145 OF N114,N116,N118,N120,N122,N124,N126:
                   N128,N130
         COMPARE   N131,N148
         GOTO      X13711 IF NOT ZERO
..............................................................................
         COMPARE   N132,N149
         GOTO      X13757 IF ZERO
..............................................................................
X13711   MOVE      N134,N35
         MOVE      N135,N36
         CALL      X6628
         COMPARE   N158,N163
         GOTO      X13757 IF ZERO
..............................................................................
         COMPARE   N133,N163
         GOTO      X13757 IF NOT LESS
..............................................................................
         MOVE      N163,N133
         MOVE      N148,N136
         MOVE      N149,N137
X13757   COMPARE   N39,N145
         GOTO      X13631 IF LESS
..............................................................................
         COMPARE   "2",N133
         GOTO      X12342 IF NOT LESS
..............................................................................
         MOVE      N134,N131
         MOVE      N135,N132
         BEEP
         MOVE      N136,N148
         MOVE      N137,N149
         GOTO      X12827
******************************************************************************
X13805   MOVE      N158,N40
         ADD       "750",N70
         DISPLAY   *P1:24,*EL,*P25:24,"*** STARBASE DESTROYED, CONG":
                   "RATULATIONS, CLOWN ***",*W;
         CMOVE     " ",S12
         CALL      X5402
         CALL      X3862
         SUB       "10",N34
         SUB       N159,N44
         COMPARE   N158,N44
         GOTO      X12342 IF NOT ZERO
..............................................................................
         DISPLAY   *P1:24,*EL,*P30:24,"NOW YOU DON'T HAVE ANY BASES":
                   ", TURKEY!",*W;
         GOTO      X12342
******************************************************************************
X13975   CALL      X5436
         CALL      X3916
         DISPLAY   *P50:8,"DAMAGE CONTROL REPORT",*P50:10,"DEVICE",*P66:10:
                   "STATE OF REPAIR",*P50:12,"WARP ENGINES",*P50:13:
                   "SHORT RANGE SENSORS",*P50:14,"LONG RANGE SENSOR":
                   "S",*P50:15,"PHASER BANKS",*P50:16,"PHOTON TORPE":
                   "DO BANKS",*P50:17,"DAMAGE CONTROL CENTRAL",*P50:18:
                   "ENERGY SHIELDS"
         COMPARE   N158,N88
         GOTO      X14227 IF LESS
..............................................................................
         DISPLAY   *P72:12,N83,*P72:13,N84,*P72:14,N85,*P72:15,N86,*P72:16:
                   N87,*P72:17,N88,*P72:18,N89
         GOTO      X8925
******************************************************************************
X14227   DISPLAY   *P79:12,"-",*P79:13,"-",*P79:14,"-",*P79:15,"-",*P79:16:
                   "-",*P72:17,N88,*P79:18,"-"
         GOTO      X8925
******************************************************************************
X14261   CALL      X5436
         MATCH     "DOCKED",S5
         GOTO      X14337 IF NOT ZERO
..............................................................................
         BEEP
         DISPLAY   *P40:24,"YOU CANNOT SELF-DESTRUCT WHEN DOCKED!";
         GOTO      X9084
******************************************************************************
X14337   DISPLAY   *ES,"DESTRUCT SEQUENCE ENTERED -"
         KEYIN     *P1:3,"SIR, ENTER SECRET PASSWORD FOR VERIFICATI":
                   "ON OF ORDER ",S2
         MATCH     S2,S1
         GOTO      X14524 IF ZERO
..............................................................................
         BEEP
         DISPLAY   *N,*N,"DESTRUCT SEQUENCE TERMINATED - SANITY RES":
                   "TORED",*W,*W
         MOVE      "2",N150
         GOTO      X8343
******************************************************************************
         MATCH     "DOCKED",S5
         GOTO      X14337 IF NOT ZERO
..............................................................................
X14524   DISPLAY   *N,*N,*N,"DESTRUCT SEQUENCE VERIFIED",*N,"   FIV":
                   "E SECOND COUNTDOWN ENTERED => ",*P37:8,"5",*W,*P37:8:
                   "4",*W,*P37:8,"3",*W,*P37:8,"2",*W,*P37:8,N159,*W:
                   *ES,*P37:12,"POOF!",*W
         SUB       N38,N42
         ADD       "1000",N70
         COMPARE   N159,N42
         GOTO      X20282 IF LESS
..............................................................................
         BEEP
         DISPLAY   *ES,*P30:12,"YOU LOSE, TURKEY!"
         GOTO      X20561
******************************************************************************
X14689   CALL      X5436
         CALL      X3916
         KEYIN     *P53:8,"BATTLE COMPUTER ACTIVATED",*P51:10,"ENTE":
                   "R FUNCTION NUMBER ",N33
         ADD       N159,N33
         BRANCH    N33 OF X8925,X14772,X14970,X15213
..............................................................................
         GOTO      X9062
******************************************************************************
X14772   COMPARE   N158,N38
         GOTO      X17218 IF ZERO
..............................................................................
         DISPLAY   *P53:9,"SENSOR REPORT ON KLINGON",*P50:10,*EL,*P58:10:
                   "ENERGY STRENGTH"
         MOVE      N159,N145
         MOVE      "12",N146
X14855   LOAD      N106 BY N145 OF N90,N107,N108,N109,N110,N111,N112
         COMPARE   N158,N106
         GOTO      X14947 IF ZERO
..............................................................................
         LOAD      N148 BY N145 OF N92,N94,N96,N98,N100,N102,N104
         LOAD      N149 BY N145 OF N93,N95,N97,N99,N101,N103,N105
         DISPLAY   *P55:N146,N106,"   (",N149,",",N148,")"
         ADD       N159,N146
X14947   ADD       N159,N145
         COMPARE   "8",N145
         GOTO      X14855 IF LESS
..............................................................................
         GOTO      X8925
******************************************************************************
X14970   KEYIN     *P50:10,"INPUT DESTINATION COORDINATES",*P53:12,"HO":
                   "RZ(X) ",N149,*P66:12,"VERT(Y) ",N148
         COMPARE   N158,N148
         GOTO      X8925 IF ZERO
..............................................................................
         COMPARE   N158,N149
         GOTO      X8925 IF ZERO
..............................................................................
         CALL      X6618
         DISPLAY   *P50:14,"DISTANCE = ",N163
         MOVE      N45,N35
         SUB       N148,N35
         MOVE      N149,N36
         SUB       N46,N36
         COMPARE   N158,N36
         GOTO      X15119 IF NOT ZERO
..............................................................................
         MOVE      "90",N64
         GOTO      X15171
******************************************************************************
X15119   MOVE      N35,N152
         DIV       N36,N152
         CALL      X6986
         MOVE      N170,N64
         COMPARE   N158,N36
         GOTO      X15171 IF NOT LESS
..............................................................................
         SUB       "180",N64
         MULT      "-1",N64
X15171   COMPARE   N158,N35
         GOTO      X15192 IF NOT LESS
..............................................................................
         MULT      "-1",N64
X15192   DISPLAY   *P50:16,"BEARING  = ",N64
         GOTO      X8925
******************************************************************************
X15213   COMPARE   N158,N65
         GOTO      X15407 IF NOT ZERO
..............................................................................
         MOVE      "6",N81
         CALL      X3841
         MULT      N160,N81
         ADD       N159,N81
         MOVE      "360",N80
         CALL      X3841
         MULT      N160,N80
X15267   MOVE      "9",N79
         CALL      X3841
         MULT      N160,N79
         MOVE      N81,N152
         MULT      ".25",N152
         COMPARE   N152,N79
         GOTO      X15267 IF LESS
..............................................................................
         DISPLAY   *P50:10,"GALAXY MAY BE REENTERED USING:",*P55:12:
                   "BEARING - ",N80,*P55:14,"DISTANCE - ",N79,*P55:16:
                   "WARP FACTOR - ",N81
         GOTO      X8925
******************************************************************************
X15407   STORE     N34 BY N65 OF N17,N18,N19,N20,N21,N22,N23,N24,N25:
                   N26,N27,N28,N29,N30,N31,N32
         DISPLAY   *P50:10,*EL,*P52:9,"COMPUTER MEMORY GALAXY MAP:":
                   *P55:11,"1 - ",N17,*P68:11,"9 - ",N25,*P55:12,"2 ":
                   "- ",N18,*P67:12,"10 - ",N26,*P55:13,"3 - ",N19,*P67:13:
                   "11 - ",N27,*P55:14,"4 - ",N20,*P67:14,"12 - ",N28:
                   *P55:15,"5 - ",N21,*P67:15,"13 - ",N29,*P55:16,"6 ":
                   "- ",N22,*P67:16,"14 - ",N30,*P55:17,"7 - ",N23,*P67:17:
                   "15 - ",N31,*P55:18,"8 - ",N24,*P67:18,"16 - ",N32
         GOTO      X8925
******************************************************************************
X15641   CALL      X5436
         COMPARE   N158,N89
         GOTO      X15689 IF NOT LESS
..............................................................................
         DISPLAY   *P40:24,"ENERGY SHIELDS DAMAGED, SIR!";
         GOTO      X8925
******************************************************************************
X15689   MATCH     "DOWN",S4
         GOTO      X15754 IF ZERO
..............................................................................
         DISPLAY   *P40:24,"ENERGY SHIELDS ALREADY ACTIVATED, SIR!";
         GOTO      X8925
******************************************************************************
X15754   COMPARE   "760",N52
         GOTO      X15806 IF NOT LESS
..............................................................................
         DISPLAY   *P40:24,"SHIELD ENERGY DRAINED, SIR!";
         GOTO      X8925
******************************************************************************
X15806   SUB       "10",N52
         MOVE      "UP  ",S4
         DISPLAY   *P40:24,"ENERGY SHIELDS ACTIVATED, SIR!",*P58:3,N52:
                   *P69:3,S4;
         GOTO      X8925
******************************************************************************
X15887   CALL      X5436
         COMPARE   N158,N89
         GOTO      X15978 IF LESS
..............................................................................
         MATCH     "DOWN",S4
         GOTO      X15978 IF ZERO
..............................................................................
         MOVE      "DOWN",S4
         DISPLAY   *P40:24,"ENERGY SHIELDS DEACTIVATED, SIR!",*P69:3:
                   S4;
         GOTO      X8925
******************************************************************************
X15978   DISPLAY   *P40:24,"ENERGY SHIELDS ALREADY DEACTIVATED, SIR":
                   "!";
         GOTO      X8925
******************************************************************************
X16026   CALL      X5436
         COMPARE   N158,N89
         GOTO      X16074 IF NOT LESS
..............................................................................
         DISPLAY   *P40:24,"ENERGY SHIELDS DAMAGED, SIR!";
         GOTO      X8925
******************************************************************************
X16074   CALL      X3916
         KEYIN     *P50:8,"DIRECTION OF TRANSFER",*P50:10,"1 - SHIE":
                   "LD => SHIP ",*P50:11,"2 - SHIP => SHIELD ",N33,*P55:13:
                   "UNITS OF ENERGY ",N64
         COMPARE   N159,N33
         GOTO      X16327 IF ZERO
..............................................................................
         COMPARE   "2",N33
         GOTO      X9062 IF NOT ZERO
..............................................................................
         COMPARE   N50,N62
         GOTO      X16257 IF LESS
..............................................................................
         DISPLAY   *P40:24,"SHIP'S ENERGY TOO LOW TO EFFECT TRANSFE":
                   "R";
         GOTO      X8925
******************************************************************************
X16257   COMPARE   N64,N50
         GOTO      X9062 IF LESS
..............................................................................
         SUB       N64,N50
         COMPARE   N62,N50
         GOTO      X16295 IF NOT LESS
..............................................................................
         SUB       N62,N50
         ADD       N50,N64
         MOVE      N62,N50
X16295   ADD       N64,N52
         COMPARE   N52,N51
         GOTO      X16370 IF NOT LESS
..............................................................................
         SUB       N51,N52
         ADD       N52,N50
         MOVE      N51,N52
         GOTO      X16408
******************************************************************************
X16327   COMPARE   N64,N52
         GOTO      X9062 IF LESS
..............................................................................
         SUB       N64,N52
         ADD       N64,N50
         COMPARE   N50,N49
         GOTO      X16370 IF NOT LESS
..............................................................................
         SUB       N49,N50
         ADD       N50,N52
         MOVE      N49,N50
X16370   COMPARE   "750",N52
         GOTO      X16408 IF NOT LESS
..............................................................................
         MOVE      "DOWN",S4
X16408   DISPLAY   *P58:2,N50,*P58:3,N52,*P69:3,S4
         GOTO      X8925
******************************************************************************
X16428   KEYIN     *P45:24,"IMPULSE ENGINES ON STANDBY",*P1:24,"BEA":
                   "RING? ",N152,*P25:24,"DISTANCE? ",N67,*P1:24,*EL;
         COMPARE   "1.00",N67
         GOTO      X8925 IF LESS
..............................................................................
         COMPARE   "20.01",N67
         GOTO      X9062 IF NOT LESS
..............................................................................
         CALL      X6050
         CALL      X18444
         MOVE      N67,N152
         MULT      "1.8",N152
         SUB       N152,N50
         MULT      ".04",N152
         CALL      X5441
         DISPLAY   *P58:2,N50
         MULT      ".05",N67
         MOVE      "1.25",N66
         MOVE      N158,N76
         MOVE      N158,N73
         COMPARE   N158,N65
         GOTO      X16632 IF ZERO
..............................................................................
         MOVE      N159,N76
X16632   MOVE      N158,N147
         MOVE      N45,N47
         MOVE      N46,N48
         MOVE      N45,N148
         MOVE      N46,N149
         CALL      X5272
         CMOVE     " ",S12
         CALL      X5402
         CALL      X3866
X16676   ADD       N78,N47
         ADD       N77,N48
         COMPARE   ".6",N47
         GOTO      X9908 IF LESS
..............................................................................
         COMPARE   "20.4",N47
         GOTO      X9958 IF NOT LESS
..............................................................................
         COMPARE   ".6",N48
         GOTO      X16860 IF LESS
..............................................................................
         COMPARE   "20.4",N48
         GOTO      X16860 IF NOT LESS
..............................................................................
         COMPARE   N158,N84
         GOTO      X16771 IF LESS
..............................................................................
         DISPLAY   *PN149:N148," "
X16771   MOVE      N47,N148
         MOVE      N48,N149
         CALL      X5272
         CMATCH    " ",S12
         GOTO      X10060 IF NOT ZERO
..............................................................................
X16792   CMOVE     "E",S12
         CALL      X3866
         ADD       ".05",N147
         COMPARE   N67,N147
         GOTO      X16676 IF LESS
..............................................................................
         MOVE      N47,N148
         MOVE      N48,N149
         MOVE      N148,N45
         MOVE      N149,N46
         CALL      X5402
         DISPLAY   *P74:1,N46,",",N45
         CALL      X18433
         GOTO      X8925
******************************************************************************
X16860   COMPARE   N158,N84
         GOTO      X9747 IF LESS
..............................................................................
         DISPLAY   *PN149:N148," "
         GOTO      X9747
******************************************************************************
X16880   CALL      X5436
         COMPARE   N158,N71
         GOTO      X16957 IF ZERO
..............................................................................
         MOVE      N158,N71
         DISPLAY   *P30:24,"EXPERIMENTAL CLOAKING DEVICE DEACTIVATE":
                   "D, SIR!";
         GOTO      X8925
******************************************************************************
X16957   COMPARE   N158,N72
         GOTO      X17018 IF NOT ZERO
..............................................................................
         DISPLAY   *P35:24,"*** CLOAKING DEVICE NON-FUNCTIONAL, SIR":
                   "! ***";
         GOTO      X9084
******************************************************************************
X17018   COMPARE   "1600",N50
         GOTO      X17081 IF NOT LESS
..............................................................................
         DISPLAY   *P40:24,"INSUFFICIENT ENERGY TO ACTIVATE, SIR!";
         GOTO      X9084
******************************************************************************
X17081   MOVE      N159,N71
         MOVE      "2",N73
         SUB       "100",N50
         DISPLAY   *P58:2,N50,*P30:24,"EXPERIMENTAL CLOAKING DEVICE":
                   " ACTIVATED, SIR!";
         GOTO      X8925
******************************************************************************
X17173   MOVE      N159,N152
         CALL      X5441
         SUB       "50",N50
         DISPLAY   *P58:2,N50
         GOTO      X8943
******************************************************************************
X17203   CALL      X5436
         CALL      X3916
         COMPARE   N158,N38
         GOTO      X17270 IF NOT ZERO
..............................................................................
X17218   DISPLAY   *P50:10,*EL,*P59:10,"HEY, DUMMY!",*P52:11,"THERE":
                   " ARE NO KLINGONS HERE"
         GOTO      X9062
******************************************************************************
X17270   COMPARE   N158,N71
         CALL      X6952 IF NOT ZERO
         DISPLAY   *P53:8,"CAPTAIN KIRK TO KLINGON",*P51:9,"COMMAND":
                   "ER: DO YOU YIELD SIR?",*P53:10,"SIR! I HAVE THE":
                   " KLINGON",*P50:11,"COMMANDER ON HAILING FREQUEN":
                   "CY",*P50:12,"MESSAGE IS:"
         BEEP
         COMPARE   N158,N90
         GOTO      X17874 IF NOT ZERO
..............................................................................
         CALL      X5059
         COMPARE   "65",N106
         GOTO      X17831 IF NOT LESS
..............................................................................
         COMPARE   "20",N106
         GOTO      X17481 IF LESS
..............................................................................
         CALL      X3841
         COMPARE   ".5",N160
         GOTO      X17831 IF LESS
..............................................................................
X17481   SUB       N38,N42
         ADD       N38,N43
         MOVE      N34,N145
         MOVE      N145,N34
         DISPLAY   *P59:14,"* I YIELD *",*P66:6,N42
         CALL      X4188
         MOVE      N158,N38
         MOVE      N37,N145
X17535   LOAD      N148 BY N145 OF N94,N96,N98,N100,N102,N104
         COMPARE   N158,N148
         GOTO      X17611 IF ZERO
..............................................................................
         LOAD      N149 BY N145 OF N95,N97,N99,N101,N103,N105
         CALL      X5272
         CMOVE     " ",S12
         CALL      X5402
         CALL      X3866
         STORE     N158 BY N145 OF N94,N96,N98,N100,N102,N104
X17611   SUB       N159,N145
         GOTO      X17535 IF NOT ZERO
..............................................................................
         DISPLAY   *P50:16,"CAPTURED KLINGON CREW SENT TO",*P53:17,"ST":
                   "ARFLEET COMMAND TO BE",*P52:18,"MERCILESSLY TOR":
                   "TURED, ETC."
         CALL      X3841
         COMPARE   ".025",N160
         GOTO      X8925 IF NOT LESS
..............................................................................
         BEEP
         DISPLAY   *P50:16,*W,*EL,*P54:16,"KLINGON WOMEN TAKEN TO",*P50:17:
                   *EL,"CAPTAIN'S CABIN FOR INTENSIVE",*P50:18,*EL,*P55:18:
                   "INTERROGATION, ETC."
         GOTO      X8925
******************************************************************************
X17831   CALL      X3841
         COMPARE   ".5",N160
         GOTO      X17874 IF LESS
..............................................................................
         DISPLAY   *P57:14,"NO WAY, TURKEY!",*W
         GOTO      X8943
******************************************************************************
X17874   DISPLAY   *P55:14,"YOU MUST BE JOKING,",*P57:15,"PREPARE T":
                   "O DIE!",*W
         GOTO      X8943
******************************************************************************
X17926   CALL      X3916
         KEYIN     *P50:8,"0 - WARP DRIVE",*P50:9,"1 - SHORT RANGE ":
                   "SENSORS",*P50:10,"2 - LONG RANGE SENSORS",*P50:11:
                   "3 - PHASERS",*P50:12,"4 - PHOTON TORPEDOES",*P50:13:
                   "5 - DAMAGE CONTROL REPORT",*P50:14,"6 - SELF-DE":
                   "STRUCT",*P50:15,"7 - BATTLE COMPUTER",*P54:16,"1 ":
                   "- KLINGON ENERGY STRENGTH",*P54:17,"2 - DISTANC":
                   "E & BEARING CALC",*P54:18,"3 - GALAXY DATA",*P1:24:
                   *EOFF,N150;
         CALL      X3916
         DISPLAY   *P50:9,"8 - ACTIVATE ENERGY SHIELDS",*P50:10,"9 ":
                   "- DEACTIVATE ENERGY SHIELDS",*P50:11,"10 - ENER":
                   "GY TRANSFER",*P50:12,"11 - IMPULSE ENGINES",*P50:13:
                   "12 - EXP. CLOAKING DEVICE",*P50:14,"13 - WAIT",*P50:15:
                   "14 - ASK KLINGONS TO SURRENDER",*P50:16,"15 - D":
                   "ISPLAY COMMANDS",*P50:17,"16 - ROLLOUT"
         GOTO      X8991
******************************************************************************
         TABPAGE
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
X18433   MOVE      N56,N59
         ADD       N75,N59
         RETURN
******************************************************************************
X18444   CALL      X19049
         COMPARE   N158,N38
         RETURN    IF ZERO
..............................................................................
         CALL      X18433
         COMPARE   N158,N71
         GOTO      X18480 IF ZERO
..............................................................................
         COMPARE   "-1",N73
         RETURN    IF ZERO
..............................................................................
X18480   MATCH     "DOCKED",S5
         GOTO      X18561 IF NOT ZERO
..............................................................................
         BEEP
         DISPLAY   *P10:24,*EL,"*** STARBASE SHIELDS PROTECT THE EN":
                   "TERPRISE ***",*W,*P1:24,*EL;
         RETURN
******************************************************************************
X18561   MOVE      N158,N145
X18566   ADD       N159,N145
         LOAD      N106 BY N145 OF N90,N107,N108,N109,N110,N111,N112
         COMPARE   N158,N106
         GOTO      X19039 IF ZERO
..............................................................................
         LOAD      N148 BY N145 OF N92,N94,N96,N98,N100,N102,N104
         LOAD      N149 BY N145 OF N93,N95,N97,N99,N101,N103,N105
         MOVE      N106,N64
         CALL      X6668
         COMPARE   N158,N71
         GOTO      X18761 IF ZERO
..............................................................................
         MOVE      N73,N106
         CALL      X3841
         ADD       N160,N106
         MULT      ".5",N106
         COMPARE   ".85",N106
         GOTO      X18761 IF NOT LESS
..............................................................................
         BEEP
         DISPLAY   *P1:24,*EL,*P20:24,"*** KLINGON AT SECTOR ",N149:
                   ",",N148," MISSED ***",*W,*P1:24,*EL;
         GOTO      X19039
******************************************************************************
X18761   MATCH     "DOWN",S4
         GOTO      X18924 IF ZERO
..............................................................................
         MOVE      N51,N152
         SUB       N52,N152
         DIV       N51,N152
         MULT      N64,N152
         MOVE      N64,N153
         MULT      ".25",N153
         SUB       N152,N50
         SUB       N153,N52
         COMPARE   "750",N52
         GOTO      X18934 IF NOT LESS
..............................................................................
         COMPARE   N158,N52
         GOTO      X18859 IF NOT LESS
..............................................................................
         MOVE      N158,N52
X18859   MOVE      "DOWN",S4
         BEEP
         DISPLAY   *P1:24,*EL,*P40:24,"*** SHIELDS KNOCKED OUT ***":
                   *W,*P1:24,*EL,*P69:3,S4;
         GOTO      X18934
******************************************************************************
X18924   SUB       N64,N50
         MOVE      N64,N152
X18934   BEEP
         DISPLAY   *P1:24,*EL,"** ",N64," UNIT HIT ON ENTERPRISE FR":
                   "OM KLINGON AT SECTOR ",N149,",",N148," **",*W,*P58:2:
                   N50,*P58:3,N52,*P1:24,*EL;
         COMPARE   "300",N152
         CALL      X5626 IF NOT LESS
X19039   COMPARE   N145,N37
         GOTO      X18566 IF NOT LESS
..............................................................................
         RETURN
******************************************************************************
X19049   COMPARE   N158,N90
         GOTO      X19125 IF ZERO
..............................................................................
         COMPARE   "50",N90
         GOTO      X19163 IF LESS
..............................................................................
         MOVE      N90,N106
         MULT      "1.5",N106
         COMPARE   N91,N106
         GOTO      X19218 IF LESS
..............................................................................
         MATCH     "DOCKED",S5
         GOTO      X19218 IF ZERO
..............................................................................
         GOTO      X19163
******************************************************************************
X19125   COMPARE   N158,N91
         GOTO      X19163 IF ZERO
..............................................................................
         COMPARE   N158,N65
         GOTO      X19163 IF ZERO
..............................................................................
         CALL      X3841
         COMPARE   ".05",N160
         GOTO      X19306 IF LESS
..............................................................................
X19163   COMPARE   N158,N38
         GOTO      X19217 IF ZERO
..............................................................................
         CALL      X3841
         COMPARE   ".65",N160
         GOTO      X19217 IF LESS
..............................................................................
         CALL      X5059
         COMPARE   "51",N106
         GOTO      X19441 IF NOT LESS
..............................................................................
X19217   RETURN
******************************************************************************
X19218   CALL      X5100
         BEEP
         DISPLAY   *P25:24,"*** KLINGON COMMAND SHIP WARPING OUT OF":
                   " QUADRANT ***",*W;
         MOVE      N92,N148
         MOVE      N93,N149
         CALL      X5272
         CMOVE     " ",S12
         CALL      X5402
         CALL      X3866
         GOTO      X19163
******************************************************************************
X19306   MOVE      N91,N90
         BEEP
         CALL      X3916
         DISPLAY   *P55:9,"EMERGENGY ALERT!",*P50:11,"SENSORS INDIC":
                   "ATE",*P55:12,"KLINGON COMMAND SHIP",*P60:13,"EN":
                   "TERING QUADRANT!"
         CALL      X5210
         CMOVE     "C",S12
         CALL      X5402
         MOVE      N148,N92
         MOVE      N149,N93
         CALL      X3866
         ADD       N159,N38
         ADD       "100",N34
         RETURN
******************************************************************************
X19441   BEEP
         DISPLAY   *P1:24,*EL,"*** SIR! SENSORS INDICATE THAT KLING":
                   "ONS ARE ENGAGING WARP DRIVE ***",*W,*P1:24,*EL;
         COMPARE   N158,N90
         GOTO      X19588 IF ZERO
..............................................................................
         MOVE      N92,N148
         MOVE      N93,N149
         CALL      X5272
         CMOVE     " ",S12
         CALL      X5402
         CALL      X3866
         CALL      X5210
         CMOVE     "C",S12
         CALL      X5402
         MOVE      N148,N92
         MOVE      N149,N93
         CALL      X3866
         COMPARE   N158,N37
         RETURN    IF ZERO
..............................................................................
X19588   MOVE      N37,N145
X19593   LOAD      N106 BY N145 OF N107,N108,N109,N110,N111,N112
         COMPARE   "50",N106
         GOTO      X19731 IF LESS
..............................................................................
         LOAD      N148 BY N145 OF N94,N96,N98,N100,N102,N104
         LOAD      N149 BY N145 OF N95,N97,N99,N101,N103,N105
         CALL      X5272
         CMOVE     " ",S12
         CALL      X5402
         CALL      X3866
         CALL      X5210
         CMOVE     "K",S12
         CALL      X5402
         STORE     N148 BY N145 OF N94,N96,N98,N100,N102,N104
         STORE     N149 BY N145 OF N95,N97,N99,N101,N103,N105
         CALL      X3866
X19731   SUB       N159,N145
         GOTO      X19593 IF NOT ZERO
..............................................................................
         RETURN
******************************************************************************
X19741   MOVE      N41,N152
         SUB       N42,N152
         DIV       N56,N152
         MULT      "1000",N152
         COMPARE   N158,N74
         GOTO      X19792 IF ZERO
..............................................................................
         MULT      "1.2",N152
X19792   MOVE      N43,N153
         MULT      "100",N153
         ADD       N153,N152
         MOVE      N152,N64
         SUB       N70,N64
         BEEP
         RETURN
******************************************************************************
X19827   CALL      X19741
         DISPLAY   *ES,*P5:10,"IT IS STARDATE - ",N56
         COMPARE   N58,N56
         GOTO      X19897 IF LESS
..............................................................................
         DISPLAY   *P5:12,"YOU HAVE RUN OUT OF TIME."
         GOTO      X20035
******************************************************************************
X19897   COMPARE   N61,N50
         GOTO      X19960 IF NOT LESS
..............................................................................
         DISPLAY   *P5:11,"ENERGY = ",N50,*P5:12,"THIS IS TOO LOW T":
                   "O SUSTAIN LIFE."
         GOTO      X20035
******************************************************************************
X19960   DISPLAY   *P5:11,"ENTERPRISE DESTROYED THROUGH NEGLIGENCE":
                   *P7:12,"OF INCOMPETENT CAPTAIN"
X20035   DISPLAY   *P5:14,"YOU HAVE RISKED THE FUTURE AND LOST",*P10:15:
                   "(THAT MEANS NO PROMOTION, TURKEY)",*P10:16,"RAT":
                   "ING = ",N64,"     ERRORS = ",N70
         COMPARE   N158,N42
         GOTO      X20218 IF ZERO
..............................................................................
         DISPLAY   *P5:18,"THERE ";
         COMPARE   N159,N42
         GOTO      X20177 IF NOT ZERO
..............................................................................
         DISPLAY   "IS";
         GOTO      X20182
******************************************************************************
X20177   DISPLAY   "ARE";
X20182   DISPLAY   " STILL ",N42," KLINGON";
         GOTO      X20208 IF ZERO
..............................................................................
         DISPLAY   "S";
X20208   DISPLAY   " LEFT"
         GOTO      X20561
******************************************************************************
X20218   DISPLAY   *P5:18,"THERE ARE NO KLINGONS LEFT, BUT YOU ARE ":
                   "STILL DEAD"
         GOTO      X20561
******************************************************************************
X20282   CALL      X19741
         SUB       N55,N56
         DISPLAY   *ES,*P15:10,"CONGRATULATIONS, CAPTAIN,",*P20:11,"YO":
                   "UR MISSION WAS A SUCCESS",*P20:12,N41," KLINGON":
                   "S IN ",N56," DAYS."
         COMPARE   N158,N43
         GOTO      X20411 IF ZERO
..............................................................................
         DISPLAY   *P20:13,N43," KLINGONS CAPTURED."
X20411   COMPARE   "7",N150
         GOTO      X20465 IF NOT ZERO
..............................................................................
         DISPLAY   *P15:14,"ENTERPRISE DESTROYED INTENTIONALLY"
X20465   DISPLAY   *P20:15,"RATING = ",N64,"     ERRORS = ",N70
         COMPARE   "6000",N64
         GOTO      X20561 IF LESS
..............................................................................
         DISPLAY   *P25:16,"YOU HAVE BEEN PROMOTED TO COMMODORE"
X20561   KEYIN     *W,*W,*P1:24,"ANOTHER GAME? ",S2,*ES
         CMATCH    "Y",S2
         GOTO      EOJ IF NOT EQUAL
..............................................................................
         MOVE      N49,N50
         MOVE      N51,N52
         MOVE      N53,N54
         MOVE      "UP  ",S4
         MOVE      "5000",N91
         MOVE      N158,N90
         MOVE      N158,N41
         MOVE      N158,N44
         MOVE      N159,N72
         MOVE      "17",N145
X20667   STORE     N158 BY N145 OF N83,N84,N85,N86,N87,N88,N89,N107:
                   N108,N109,N110,N111,N112,N43,N71,N70,N74
         SUB       N159,N145
         GOTO      X20667 IF NOT ZERO
..............................................................................
         GOTO      X2308
******************************************************************************
X20719   KEYIN     *ES,*P10:12,"ARE YOU SURE YOU WANT TO ROLLOUT? ":
                   S2
         MOVE      "2",N150
         CMATCH    "Y",S2
         GOTO      X8343 IF NOT ZERO
..............................................................................
         CHAIN     "MASTER"
******************************************************************************
         GOTO      X8343
******************************************************************************
X20802   MATCH     "BWC",S1
         GOTO      X9062 IF NOT ZERO
..............................................................................
         DISPLAY   *ES,*N,"A1 = ",N1,*N,"A2 = ",N2,*N,"A3 = ",N3,*N:
                   "A4 = ",N4,*N,"A5 = ",N5,*N,"A6 = ",N6,*N,"A7 = ":
                   N7,*N,"A8 = ",N8,*N,"A9 = ",N9,*N,"A10= ",N10,*N:
                   "A11= ",N11,*N,"A12= ",N12,*N,"A13= ",N13,*N,"A1":
                   "4= ",N14,*N,"A15= ",N15,*N,"A16= ",N16,*P40:10,"QK":
                   " = ",N37,*P50:10,"QB = ",N40,*P60:10,"QS = ",N39:
                   *P40:12,"TK = ",N41,*P50:12,"TB = ",N44,*P40:14,"CS":
                   "MP = ",N91,*P60:14,"PROB = ",N73
         GOTO      X8925
******************************************************************************
EOJ      CHAIN     "MASTER"
******************************************************************************
