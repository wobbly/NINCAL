.GNXT0001 - UPDATE GNXT.DAT   RECNUM/PI FILE.
.
PC	 EQU      0
	 INCLUDE COMMON.INC
	 INCLUDE GNXTDD.INC
	 INCLUDE CONS.INC
.V	 FORM     2
RELEASE	 INIT	 "1.0"      16FEB93  DLH
.
	 MOVE    "GNXT0001" TO PROGRAM
	 CLOCK   DATE TO TODAY
	 MOVE    "Names In The News Ca Inc" TO COMPNME
	 MOVE    "UPDATE GNXT FILE " TO STITLE
MAIN	 CALL    PAINT
	 KEYIN   *P10:12,"1. DISPLAY ALL REC'S ":
		 *P10:13,"2. MODIFY A REC      ":
	         *P10:14,"3. ADD A NEW REC     ":
	         *P10:15,"4. ** EXIT **        ",STR1
	 CMATCH  B1 TO STR1 
	 GOTO    MAIN IF EQUAL
	 MOVE    STR1 TO N1
	 BRANCH  N1 TO DISS,MOD,ADD,STOP
	 COMPARE C9 TO N1
	 GOTO    DEL IF EQUAL
	 GOTO    MAIN
DISS     CALL    PAINT
	 MOVE    "12" TO V
	 MOVE    "     A" TO GNXTFLD
	 CALL    GNXTKEY
DISSKS	 CALL    GNXTKS
	 GOTO    DISSX IF OVER
	 DISPLAY *P10:V,GNXTKEY,B1,GNXTNUM
	 ADD     C1 TO V
	 COMPARE "22" TO V
	 IF 	 EQUAL 
	 MOVE    "12" TO V
	 KEYIN   *P1:24,*B,*EL,"THERE ARE MORE (ENTER) TO CONTINUE",STR1
	 CALL    PAINT
	 ENDIF
	 GOTO    DISSKS	
DISSX    KEYIN   *P1:24,*EL,"DONE (ENTER) TO CONTINUE  ",*B,STR1
	 GOTO     MAIN
MOD	 KEYIN    *P1:4,*EF:
		  *P10:12,"KEY TO BE UPDATED ",GNXTFLD
	 CMATCH   STAR TO GNXTFLD
	 GOTO     MOD IF EOS
	 GOTO     MAIN IF EQUAL
	 CALL     GNXTKEY
	 IF	  OVER
	 DISPLAY  *P10:14,"NO RECORD FOUND",*B
	 PAUSE    "2"
	 GOTO     MOD
	 ENDIF
	 DISPLAY  *P10:14,GNXTKEY,B1,GNXTNUM
	 KEYIN    *P10:16,"NEW NUMBER ",*ZF,*JR,GNXTNUM,*P63:16,"OK? ",STR1
	 CMATCH   YES TO STR1
	 GOTO     MOD IF NOT EQUAL
	 CALL     GNXTUPD
	 GOTO     MOD
ADD	 KEYIN    *P1:4,*EF:
		  *P10:12,"KEY TO BE ADDED ",GNXTFLD
	 CMATCH   STAR TO GNXTFLD
	 GOTO     MOD IF EOS
	 GOTO     MAIN IF EQUAL
	 CALL     GNXTTST
	 IF       NOT OVER
	 DISPLAY  *P10:14,GNXTKEY,B1,GNXTNUM
	 DISPLAY  *P10:24,*EL,*B,"RECORD ALREADY EXISTS!!!!",*B,*W4
	 GOTO     MAIN
	 ENDIF
	 KEYIN    *P10:16,"NEW NUMBER ",*ZF,*JR,GNXTNUM,*P63:16,"OK? ",STR1
	 CMATCH   YES TO STR1
	 GOTO     MOD IF NOT EQUAL
	 MOVE     GNXTFLD TO GNXTKEY
	 CALL     GNXTWRT
	 GOTO     MAIN
DEL 	 KEYIN    *P1:4,*EF:
		  *P10:12,"KEY TO BE DELETED ",GNXTFLD
	 CMATCH   STAR TO GNXTFLD
	 GOTO     MOD IF EOS
	 GOTO     MAIN IF EQUAL
	 CALL     GNXTKEY
	 DISPLAY  *P10:14,GNXTKEY,B1,GNXTNUM
	 KEYIN    *P10:16,"OK TO DELETE ? ",*DV,GNXTKEY,STR1
	 CMATCH   YES TO STR1
	 GOTO     DEL IF NOT EQUAL
	 CALL     GNXTDEL
	 GOTO      MAIN
STOP	 STOP	
	 INCLUDE  GNXTIO.INC
	 INCLUDE  COMLOGIC.INC

