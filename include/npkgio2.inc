..............................................................................
.
. NPKGIO2 INCLUSION
. NIN PACKAGE 'Get Next Record' FILE IO ROUTINES
.
. FILE NAME : PKGNXT.DAT
.
. REC LENGTH:	25 FIXED
. INDEX KEY :	001-004	Mailer
.
.
..............................................................................
.NPKGNXTKEY - Isam key read
.
. ENTRY POINT : NPKGNXTKEY
. REQUIRED    : 'NPKGNXTFLD'
. RETURNED    : PACKAGE GET NEXT RECORD
. DESCRIPTION : EXACT ISAM KEY READ
.               APPLICATION'S RESPONSIBILITY TO TEST FLAGS
.
NPKGNXTKEY
	BRANCH	NPKGNXTFLAG TO NPKGNXT1
	CALL	NPKGNXTOPEN
NPKGNXT1
	trap	IOMssg giving Error if IO
	FILEPI	1;NPKGNXTFILE
	READ	NPKGNXTFILE,NPKGNXTFLD;NPKGNXTVARS
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NPKGNXTTST
. REQUIRED    : 'NPKGNXTFLD'
. RETURNED    :
. DESCRIPTION : TEST KEY
.
NPKGNXTTST
	BRANCH	NPKGNXTFLAG TO NPKGNXT2
	CALL	NPKGNXTOPEN
NPKGNXT2
	trap	IOMssg giving Error if IO
	FILEPI	1;NPKGNXTFILE
	READ	NPKGNXTFILE,NPKGNXTFLD;;
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NPKGNXTSEQ
. REQUIRED    :
. RETURNED    : PACKAGE GET NEXT RECORD
. DESCRIPTION : SEQUENTIAL PACKAGE GET NEXT FILE READ
.               APPLICATION'S RESPONSIBILITY TO TEST FLAGS
.
NPKGNXTSEQ
	BRANCH	NPKGNXTFLAG TO NPKGNXT4
	CALL	NPKGNXTOPEN
NPKGNXT4
	trap	IOMssg giving Error if IO
	FILEPI	1;NPKGNXTFILE
	READ	NPKGNXTFLE2,SEQ;NPKGNXTVARS
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NPKGNXTWRT
. REQUIRED    :
. RETURNED    :
. DESCRIPTION : EXACT ISAM KEY TXT/ISI INSERT
.
NPKGNXTWRT
	BRANCH    NPKGNXTFLAG OF NPKGNXT5
	CALL      NPKGNXTOPEN
NPKGNXT5
	trap      IOMssg giving Error if IO
	FILEPI    1;NPKGNXTFILE
	WRITE     NPKGNXTFILE;NPKGNXTVARS
	trapclr   IO
	RETURN
..............................................................................
.
. ENTRY POINT : NPKGNXTUPD
. REQUIRED    : A PREVIOUS KEY READ
. RETURNED    :
. DESCRIPTION : KEY UPDATE PACKAGE FILE
.
NPKGNXTUPD
	BRANCH	NPKGNXTFLAG TO NPKGNXT6
	CALL	NPKGNXTOPEN
NPKGNXT6
	trap	IOMssg giving Error if IO
	FILEPI	1;NPKGNXTFILE
	UPDATE	NPKGNXTFILE;NPKGNXTVARS
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NPKGNXTDEL
. REQUIRED    : VALID FILE READ
. RETURNED    :
. DESCRIPTION : EXACT ISAM KEY TXT/ISI DELETE
.
NPKGNXTDEL
	BRANCH	NPKGNXTFLAG TO NPKGNXT7
	CALL	NPKGNXTOPEN
NPKGNXT7
	trap	IOMssg giving Error if IO
	FILEPI	1;NPKGNXTFILE
	DELETE	NPKGNXTFILE
	trapclr	IO
	RETURN
..............................................................................
.
. ENTRY POINT : NPKGNXTOPEN
. REQUIRED    : 'NPKGNXTFLAG'
. RETURNED    : 'NPKGNXTFLAG' SET TO '1' IF OPENNED
. DESCRIPTION : OPEN NIN PACKAGE 'GET NEXT RECORD' FILE
.               DISPLAY ERROR AND ABORT IF NOT ON-LINE.
.
NPKGNXTOPEN
	TRAP	NPKGNXTGONE giving Error IF IO
	BRANCH	NPKGNXTLOCK TO NPKGNXTOPNL,NPKGNXTOPNR

NPKGNXTOPNL
	OPEN	NPKGNXTFILE,NPKGNXTNAME
	OPEN	NPKGNXTFLE2,NPKGNXTNAME
	TRAPCLR	IO
	MOVE	C1 TO NPKGNXTFLAG
	RETURN
NPKGNXTOPNR
	OPEN	NPKGNXTFILE,NPKGNXTNAME,LOCKMANUAL,SINGLE
	OPEN	NPKGNXTFLE2,NPKGNXTNAME
	TRAPCLR	IO
	MOVE	C1 TO NPKGNXTFLAG
	RETURN
.
NPKGNXTGONE
	MOVE	NPKGNXTNAME TO FILENAME
	CALL	FILEGONE
..............................................................................
.END OF INCLUDE
